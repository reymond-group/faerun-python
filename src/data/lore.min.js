(function(){function c(m,e,t){function r(s,o){if(!e[s]){if(!m[s]){var i="function"==typeof require&&require;if(!o&&i)return i(s,!0);if(n)return n(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var d=e[s]={exports:{}};m[s][0].call(d.exports,function(t){var e=m[s][1][t];return r(e?e:t)},d,d.exports,c,m,e,t)}return e[s].exports}for(var n="function"==typeof require&&require,s=0;s<t.length;s++)r(t[s]);return r}return c})()({1:[function(e,t){"use strict";function o(e){let t=Object.keys(e).reduce((t,o)=>(t[e[o]]=o,t),{});return Object.freeze(Object.keys(e).reduce((t,o)=>(t[o]=e[o],t),(e)=>t[e]))}var n=!!("undefined"!=typeof window&&window.document&&window.document.createElement),r=e("./src/Lore");r.Mouse=o({Left:0,Middle:1,Right:2}),r.Keyboard=o({Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Esc:27}),r.init=function(e,t){this.opts=r.Utils.extend(!0,r.defaults,t);var o=r.Core.Color.fromHex(this.opts.clearColor),n=new r.Core.Renderer(e,{clearColor:o,verbose:!0,fps:document.getElementById("fps"),center:new r.Math.Vector3f(125,125,125),antialiasing:this.opts.antialiasing});return n.controls.limitRotationToHorizon(this.opts.limitRotationToHorizon),n.render=function(e,t){for(var o in t)t[o].draw(n)},n},r.getGrakaInfo=function(e){let t=document.getElementById(e),o=t.getContext("webgl")||t.getContext("experimental-webgl"),n={renderer:"",vendor:""},r=o.getExtension("WEBGL_debug_renderer_info");return null!=r&&(n.renderer=o.getParameter(r.UNMASKED_RENDERER_WEBGL),n.vendor=o.getParameter(r.UNMASKED_VENDOR_WEBGL)),n},r.supportsHighQuality=function(e){r.getGrakaInfo(e);return!1},r.defaults={clearColor:"#121212",limitRotationToHorizon:!1,antialiasing:!1},n&&(window.Lore=r),t.exports=r},{"./src/Lore":36}],2:[function(e,t){"use strict";var o=Math.round;const n=e("../Core/Node"),r=e("../Math/ProjectionMatrix"),s=e("../Math/Matrix4f"),i=e("../Math/Vector3f");t.exports=class extends n{constructor(){super(),this.type="Lore.CameraBase",this.renderer=null,this.isProjectionMatrixStale=!1,this.isViewMatrixStale=!1,this.projectionMatrix=new r,this.viewMatrix=new s,this.near=0,this.far=1e3}init(e,t){return this.gl=e,this.program=t,this}setLookAt(e){return this.rotation.lookAt(this.position,e,i.up()),this}updateViewport(){return this}updateProjectionMatrix(){return this}updateViewMatrix(){this.update();let e=this.modelMatrix.clone();return e.invert(),this.viewMatrix=e,this.isViewMatrixStale=!0,this}getProjectionMatrix(){return this.projectionMatrix.entries}getViewMatrix(){return this.viewMatrix.entries}sceneToScreen(e,t){let n=e.clone(),r=t.canvas;s.projectVector(n,this);let i=o((n.components[0]+1)*r.width/2),a=o((-n.components[1]+1)*r.height/2);return[i,a]}}},{"../Core/Node":16,"../Math/Matrix4f":38,"../Math/ProjectionMatrix":39,"../Math/Vector3f":45}],3:[function(e,t){"use strict";const o=e("./CameraBase");t.exports=class extends o{constructor(e,t,o,n,r=.1,s=2500){super(),this.type="Lore.OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=o,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,n=(this.top+this.bottom)/2;return this.projectionMatrix.setOrthographic(o-e,o+e,n+t,n-t,this.near,this.far),this.isProjectionMatrixStale=!0,this}updateViewport(e,t){return this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this}}},{"./CameraBase":2}],4:[function(e,t){"use strict";const o=e("./CameraBase");t.exports=class extends o{constructor(e,t,o=.1,n=2500){super(),this.type="Lore.PerspectiveCamera",this.zoom=1,this.fov=e,this.aspect=t,this.near=o,this.far=n,this.updateProjectionMatrix()}updateProjectionMatrix(){return this.projectionMatrix.setPerspective(this.fov,this.aspect,this.near,this.far),this.isProjectionMatrixStale=!0,this}updateViewport(e,t){return this.aspect=e/t,this}}},{"./CameraBase":2}],5:[function(e,t){"use strict";const o=e("./CameraBase"),n=e("./OrthographicCamera"),r=e("./PerspectiveCamera");t.exports={CameraBase:o,OrthographicCamera:n,PerspectiveCamera:r}},{"./CameraBase":2,"./OrthographicCamera":3,"./PerspectiveCamera":4}],6:[function(e,t){"use strict";const o=e("../Math/Vector3f");t.exports=class{constructor(e,t=new o(0,0,0),n=!1){this.renderer=e,this.camera=e.camera,this.canvas=e.canvas,this.lowFps=15,this.highFps=30,this._eventListeners={},this.renderer.setMaxFps(this.lowFps),this.touchMode="drag",this.lookAt=t,this.mouse={previousPosition:{x:null,y:null},delta:{x:0,y:0},position:{x:0,y:0},state:{left:!1,middle:!1,right:!1},normalizedPosition:{x:0,y:0},touches:0},this.keyboard={alt:!1,ctrl:!1,shift:!1},this.VR={};let r=this;this.canvas.addEventListener("mousemove",function(t){(null!==r.mouse.previousPosition.x&&r.mouse.state.left||r.mouse.state.middle||r.mouse.state.right)&&(r.mouse.delta.x=t.pageX-r.mouse.previousPosition.x,r.mouse.delta.y=t.pageY-r.mouse.previousPosition.y,r.mouse.position.x+=.01*r.mouse.delta.x,r.mouse.position.y+=.01*r.mouse.delta.y,r.mouse.state.left?r.raiseEvent("mousedrag",{e:r.mouse.delta,source:"left"}):r.mouse.state.middle?r.raiseEvent("mousedrag",{e:r.mouse.delta,source:"middle"}):r.mouse.state.right&&r.raiseEvent("mousedrag",{e:r.mouse.delta,source:"right"}));let e=r.canvas.getBoundingClientRect();r.mouse.normalizedPosition.x=2*((t.clientX-e.left)/r.canvas.width)-1,r.mouse.normalizedPosition.y=2*-((t.clientY-e.top)/r.canvas.height)+1,r.raiseEvent("mousemove",{e:r}),r.mouse.previousPosition.x=t.pageX,r.mouse.previousPosition.y=t.pageY}),this.canvas.addEventListener("touchstart",function(t){r.mouse.touches++;let e=t.touches[0];t.preventDefault(),r.mouse.touched=!0,r.renderer.setMaxFps(r.highFps);let o=r.canvas.getBoundingClientRect();r.mouse.normalizedPosition.x=2*((e.clientX-o.left)/r.canvas.width)-1,r.mouse.normalizedPosition.y=2*-((e.clientY-o.top)/r.canvas.height)+1,"drag"!==r.touchMode&&r.raiseEvent("mousemove",{e:r}),r.raiseEvent("mousedown",{e:r,source:"touch"})}),this.canvas.addEventListener("touchend",function(t){r.mouse.touches--,t.preventDefault(),r.mouse.touched=!1,r.mouse.previousPosition.x=null,r.mouse.previousPosition.y=null,r.renderer.setMaxFps(r.lowFps),r.raiseEvent("mouseup",{e:r,source:"touch"})}),this.canvas.addEventListener("touchmove",function(t){let e=t.touches[0],o="left";2==r.mouse.touches&&(o="right"),t.preventDefault(),null!==r.mouse.previousPosition.x&&r.mouse.touched&&(r.mouse.delta.x=e.pageX-r.mouse.previousPosition.x,r.mouse.delta.y=e.pageY-r.mouse.previousPosition.y,r.mouse.position.x+=.01*r.mouse.delta.x,r.mouse.position.y+=.01*r.mouse.delta.y,"drag"===r.touchMode&&r.raiseEvent("mousedrag",{e:r.mouse.delta,source:o}));let n=r.canvas.getBoundingClientRect();r.mouse.normalizedPosition.x=2*((e.clientX-n.left)/r.canvas.width)-1,r.mouse.normalizedPosition.y=2*-((e.clientY-n.top)/r.canvas.height)+1,"drag"!==r.touchMode&&r.raiseEvent("mousemove",{e:r}),r.mouse.previousPosition.x=e.pageX,r.mouse.previousPosition.y=e.pageY});let s="mousewheel";-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(s="DOMMouseScroll"),this.canvas.addEventListener(s,function(t){t.preventDefault();let e="wheelDelta"in t?t.wheelDelta:-40*t.detail;r.raiseEvent("mousewheel",{e:e})}),this.canvas.addEventListener("keydown",function(t){16==t.which?r.keyboard.shift=!0:17==t.which?r.keyboard.ctrl=!0:18==t.which&&(r.keyboard.alt=!0),r.raiseEvent("keydown",{e:t.which})}),this.canvas.addEventListener("keyup",function(t){16==t.which?r.keyboard.shift=!1:17==t.which?r.keyboard.ctrl=!1:18==t.which&&(r.keyboard.alt=!1),r.raiseEvent("keyup",{e:t.which})}),this.canvas.addEventListener("mousedown",function(t){let e=t.button,o="left";0==e?r.mouse.state.left=!0:1==e?(r.mouse.state.middle=!0,o="middle"):2==e&&(r.mouse.state.right=!0,o="right"),r.renderer.setMaxFps(r.highFps),r.raiseEvent("mousedown",{e:r,source:o})}),this.canvas.addEventListener("click",function(t){let e=t.button;r.raiseEvent("click",{e:r,source:"left"})}),this.canvas.addEventListener("dblclick",function(t){let e=t.button;r.raiseEvent("dblclick",{e:r,source:"left"})}),this.canvas.addEventListener("mouseup",function(t){let e=t.button,o="left";0==e?r.mouse.state.left=!1:1==e?(r.mouse.state.middle=!1,o="middle"):2==e&&(r.mouse.state.right=!1,o="right"),r.mouse.previousPosition.x=null,r.mouse.previousPosition.y=null,r.renderer.setMaxFps(r.lowFps),r.raiseEvent("mouseup",{e:r,source:o})}),this.canvas.addEventListener("mouseleave",function(){r.mouse.state.left=!1,r.mouse.state.middle=!1,r.mouse.state.right=!1,r.mouse.previousPosition.x=null,r.mouse.previousPosition.y=null,r.renderer.setMaxFps(r.lowFps),r.raiseEvent("mouseleave",{e:r,source:r.canvas})})}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}removeEventListener(e,t){if(this._eventListeners.hasOwnProperty(e)){let o=this._eventListeners[e].indexOf(t);-1<o&&this._eventListeners[e].splice(o,1)}}raiseEvent(e,t={}){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}getLookAt(){return this.lookAt}setLookAt(e){return this.lookAt=e.clone(),this.update(),this}update(t=null,e=null){return this}}},{"../Math/Vector3f":45}],7:[function(e,t){"use strict";const o=e("../Controls/ControlsBase"),n=e("../Math/Vector3f");t.exports=class extends o{constructor(e,t){super(e),this.up=n.up(),this.renderer=e,this.camera=e.camera,this.canvas=e.canvas,this.camera.position=new n(t,t,t),this.camera.updateProjectionMatrix(),this.camera.updateViewMatrix(),this.rotationLocked=!1;let o=this;this.addEventListener("mousedrag",function(t){o.update(t.e,t.source)}),this.update({x:0,y:0},"left")}update(t,e){let o=this.camera.position.clone().subtract(this.lookAt);return this.camera.position.copyFrom(this.lookAt).add(o),this.camera.setLookAt(this.lookAt),this.camera.updateViewMatrix(),this.raiseEvent("updated"),this}}},{"../Controls/ControlsBase":6,"../Math/Vector3f":45}],8:[function(e,t){"use strict";var o=Math.max,n=Math.PI;const r=e("../Controls/ControlsBase"),s=e("../Math/Vector3f"),i=e("../Math/SphericalCoords");t.exports=class extends r{constructor(e,t,o=new s(0,0,0)){super(e,o),this.up=s.up(),this.radius=t,this.yRotationLimit=n,this._dPhi=0,this._dTheta=0,this._dPan=new s(0,0,0),this.spherical=new i,this.scale=.95,this.camera.position=new s(t,t,t),this.camera.updateProjectionMatrix(),this.camera.updateViewMatrix(),this.rotationLocked=!1;let r=this;this.addEventListener("mousedrag",function(t){r.update(t.e,t.source)}),this.addEventListener("mousewheel",function(t){r.update({x:0,y:-t.e},"wheel")}),this.update({x:0,y:0},"left")}limitRotationToHorizon(e){return this.yRotationLimit=e?.5*n:n,this}setRadius(e){return this.radius=e,this.camera.position=new s(0,0,e),this.camera.updateProjectionMatrix(),this.camera.updateViewMatrix(),this.update(),this}update(t=null,e=null){if("left"==e&&!this.rotationLocked)this._dTheta=-2*n*t.x/(this.canvas.clientWidth*this.camera.zoom),this._dPhi=-2*n*t.y/(this.canvas.clientHeight*this.camera.zoom);else if("right"==e||"left"==e&&this.rotationLocked){let e=t.x*(this.camera.right-this.camera.left)/this.camera.zoom/this.canvas.clientWidth,o=t.y*(this.camera.top-this.camera.bottom)/this.camera.zoom/this.canvas.clientHeight,n=this.camera.getUpVector().components,s=this.camera.getRightVector().components;this._dPan.components[0]=s[0]*-e+n[0]*o,this._dPan.components[1]=s[1]*-e+n[1]*o,this._dPan.components[2]=s[2]*-e+n[2]*o}else("middle"==e||"wheel"==e)&&(0<t.y?(this.camera.zoom=o(0,this.camera.zoom*this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom)):0>t.y&&(this.camera.zoom=o(0,this.camera.zoom/this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom)));let r=this.camera.position.clone().subtract(this.lookAt);return this.spherical.setFromVector(r),this.spherical.components[1]+=this._dPhi,this.spherical.components[2]+=this._dTheta,this.spherical.limit(0,this.yRotationLimit,-Infinity,Infinity),this.spherical.secure(),this.lookAt.add(this._dPan),r.setFromSphericalCoords(this.spherical),this.camera.position.copyFrom(this.lookAt).add(r),this.camera.setLookAt(this.lookAt),this.camera.updateViewMatrix(),this._dPhi=0,this._dTheta=0,this._dPan.set(0,0,0),this.raiseEvent("updated"),this}setView(e,t){let o=this.camera.position.clone().subtract(this.lookAt);return this.spherical.setFromVector(o),this.spherical.components[1]=e,this.spherical.components[2]=t,this.spherical.secure(),o.setFromSphericalCoords(this.spherical),this.camera.position.copyFrom(this.lookAt).add(o),this.camera.setLookAt(this.lookAt),this.camera.updateViewMatrix(),this.raiseEvent("updated"),this}zoomIn(){return this.camera.zoom=o(0,this.camera.zoom/this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom),this.raiseEvent("updated"),this}zoomOut(){return this.camera.zoom=o(0,this.camera.zoom*this.scale),this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom),this.raiseEvent("updated"),this}setZoom(e){return this.camera.zoom=e,this.camera.updateProjectionMatrix(),this.raiseEvent("zoomchanged",this.camera.zoom),this.raiseEvent("updated"),this}setTopView(){return this.setView(0,2*n),this.rotationLocked=!0,this}setBottomView(){return this.setView(0,0),this.rotationLocked=!0,this}setRightView(){return this.setView(.5*n,.5*n),this.rotationLocked=!0,this}setLeftView(){return this.setView(.5*n,-.5*n),this.rotationLocked=!0,this}setFrontView(){return this.setView(.5*n,2*n),this.rotationLocked=!0,this}setBackView(){return this.setView(.5*n,Math.PI),this.rotationLocked=!0,this}setFreeView(){return this.setView(.25*n,.25*n),this.rotationLocked=!1,this}}},{"../Controls/ControlsBase":6,"../Math/SphericalCoords":43,"../Math/Vector3f":45}],9:[function(e,t){"use strict";const o=e("./ControlsBase"),n=e("./FirstPersonControls"),r=e("./OrbitalControls");t.exports={ControlsBase:o,FirstPersonControls:n,OrbitalControls:r}},{"./ControlsBase":6,"./FirstPersonControls":7,"./OrbitalControls":8}],10:[function(e,t){"use strict";e("../Math/Vector3f");t.exports=class{constructor(e,t,o){this.type="Lore.Attribute",this.data=e,this.attributeLength=t||3,this.name=o,this.size=this.data.length/this.attributeLength,this.buffer=null,this.attributeLocation,this.bufferType=null,this.drawMode=null,this.stale=!1}setFromVector(e,t){this.data.set(t.components,e*this.attributeLength,t.components.length)}setFromVectorArray(e){if(this.attributeLength!==e[0].components.length)throw"The attribute has a length of "+this.attributeLength+". But the vectors have "+e[0].components.length+" components.";for(let t=0;t<e.length;t++)this.data.set(e[t].components,t*this.attributeLength,e[t].components.length)}getX(e){return this.data[e*this.attributeLength]}setX(e){this.data[e*this.attributeLength]}getY(e){return this.data[e*this.attributeLength+1]}setY(e){this.data[e*this.attributeLength+1]}getZ(e){return this.data[e*this.attributeLength+2]}setZ(e){this.data[e*this.attributeLength+2]}getW(e){return this.data[e*this.attributeLength+3]}setW(e){this.data[e*this.attributeLength+3]}getGlType(e){return e.FLOAT}update(e){e.bindBuffer(this.bufferType,this.buffer),e.bufferData(this.bufferType,this.data,this.drawMode),this.stale=!1}createBuffer(e,t,o,n){this.buffer=e.createBuffer(),this.bufferType=o||e.ARRAY_BUFFER,this.drawMode=n||e.STATIC_DRAW,e.bindBuffer(this.bufferType,this.buffer),e.bufferData(this.bufferType,this.data,this.drawMode),this.buffer.itemSize=this.attributeLength,this.buffer.numItems=this.size,this.attributeLocation=e.getAttribLocation(t,this.name),e.bindBuffer(this.bufferType,null)}bind(e){e.bindBuffer(this.bufferType,this.buffer),0<=this.attributeLocation&&(e.vertexAttribPointer(this.attributeLocation,this.attributeLength,this.getGlType(e),e.FALSE,0,0),e.enableVertexAttribArray(this.attributeLocation))}}},{"../Math/Vector3f":45}],11:[function(e,t){"use strict";var o=Math.round;class n{constructor(e,t,o,n=1){1===arguments.length?this.components=new Float32Array(e):(this.components=new Float32Array(4),this.components[0]=e||0,this.components[1]=t||0,this.components[2]=o||0,this.components[3]=n||1)}set(e,t,o,n){return this.components[0]=e,this.components[1]=t,this.components[2]=o,4==arguments.length&&(this.components[3]=n),this}static fromHex(e){let t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,o,n){return t+t+o+o+n+n});let o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),s=parseInt(o[1],16),r=parseInt(o[2],16),i=parseInt(o[3],16);return o?new n(s/255,r/255,i/255,1):null}static hueToRgb(e,o,n){if(0>n)n+=1;else if(1<n)n-=1;else{if(.1667>n)return e+6*(o-e)*n;if(.5>n)return o;if(.6667>n)return e+6*((o-e)*(.6667-n))}return e}static hslToRgb(e,t,o){let s,r,i;if(0==t)s=r=i=o;else{let a=.5>o?o*(1+t):o+t-o*t,c=2*o-a;s=n.hueToRgb(c,a,e+.3333),r=n.hueToRgb(c,a,e),i=n.hueToRgb(c,a,e-.3333)}return[s,r,i]}static hslToHex(e,t,s){let[i,r,a]=n.hslToRgb(e,t,s);return"#"+[o(255*i),o(255*r),o(255*a)].map((t)=>{const e=t.toString(16);return 1===e.length?"0"+e:e}).join("")}static rgbToHsl(e,t,o){e/=255,t/=255,o/=255;let n=Math.max(e,t,o),r=Math.min(e,t,o),i=(n+r)/2,a,c;if(n==r)a=c=0;else{let s=n-r;c=.5<i?s/(2-n-r):s/(n+r);n===e?a=(t-o)/s+(t<o?6:0):n===t?a=(o-e)/s+2:n===o?a=(e-t)/s+4:void 0;a/=6}return[a,c,i]}static gdbHueShift(e){return e=.85*e+.66,1<e&&--e,e=1-e+.33,1<e&&--e,e}}t.exports=n},{}],12:[function(e,t){"use strict";t.exports={points:0,lines:1,lineStrip:2,lineLoop:3,triangles:4,traingleStrip:5,triangleFan:6}},{}],13:[function(e,t){"use strict";const o=e("../Shaders");t.exports=class{constructor(e,t){this.renderer=e,this.gl=this.renderer.gl,this.framebuffer=this.initFramebuffer(),this.texture=this.initTexture(),this.renderbuffer=this.initRenderbuffer(),this.shader=o[t].clone(),this.shader.init(this.renderer.gl),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}initBuffer(){let e=this.gl,t=e.getAttribLocation(this.shader.program,"v_coord"),o=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,-1,-1,-1,-1,1,-1,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0),o}initTexture(){let e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.renderer.getWidth(),this.renderer.getHeight(),0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),t}initFramebuffer(){let e=this.gl,t=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,t),t}initRenderbuffer(){let e=this.gl,t=e.createRenderbuffer();return e.bindRenderbuffer(e.RENDERBUFFER,t),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,this.renderer.getWidth(),this.renderer.getHeight()),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),t}bind(){let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}unbind(){let e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),this.initBuffer(),this.shader.use(),e.drawArrays(e.TRIANGLES,0,6)}}},{"../Shaders":57}],14:[function(e,t){"use strict";const o=e("./DrawModes"),n=e("./Attribute"),r=e("../Math/Matrix4f"),s=e("./Node");t.exports=class extends s{constructor(e,t,o){super(),this.type="Lore.Geometry",this.name=e,this.gl=t,this.shader=o,this.attributes={},this.drawMode=this.gl.POINTS,this.isVisible=!0}addAttribute(e,t,o){return this.attributes[e]=new n(t,o,e),this.attributes[e].createBuffer(this.gl,this.shader.program),this}updateAttribute(e,t){return t&&(this.attributes[e].data=t),this.attributes[e].update(this.gl),this}getAttribute(e){return this.attributes[e]}removeAttribute(e){return delete this.attributes[e],this}setMode(e){return e===o.points?this.drawMode=this.gl.POINTS:e===o.lines?this.drawMode=this.gl.LINES:e===o.lineStrip?this.drawMode=this.gl.LINE_STRIP:e===o.lineLoop?this.drawMode=this.gl.LINE_LOOP:e===o.triangles?this.drawMode=this.gl.TRIANGLES:e===o.triangleStrip?this.drawMode=this.gl.TRIANGLE_STRIP:e===o.triangleFan?this.drawMode=this.gl.TRIANGLE_FAN:void 0,this}size(){return 0<Object.keys(this.attributes).length?this.attributes[Object.keys(this.attributes)[0]].size:0}draw(e){if(this.isVisible){for(let e in this.attributes)this.attributes[e].stale&&this.attributes[e].update(this.gl);if(this.shader.use(),e.camera.isProjectionMatrixStale&&this.shader.uniforms.projectionMatrix.setValue(e.camera.getProjectionMatrix()),e.camera.isViewMatrixStale){let t=r.multiply(e.camera.viewMatrix,this.modelMatrix);this.shader.uniforms.modelViewMatrix.setValue(t.entries)}for(let e in this.shader.updateUniforms(),this.attributes)this.attributes[e].bind(this.gl);this.gl.drawArrays(this.drawMode,0,this.size())}}}},{"../Math/Matrix4f":38,"./Attribute":10,"./DrawModes":12,"./Node":16}],15:[function(e,t){"use strict";var o=Math.abs,n=Math.sqrt,r=Math.pow;class s{constructor(e){this.adjacencyMatrix=e;for(var t=0;t<this.adjacencyMatrix.length;t++)for(var o=0;o<this.adjacencyMatrix.length;o++)0===this.adjacencyMatrix[t][o]&&(this.adjacencyMatrix[t][o]=Infinity);this.distanceMatrix=this.getDistanceMatrix(),this.diameter=this.getDiameter()}getUnweightedAdjacencyMatrix(){let e=this.adjacencyMatrix.length,t=Array(e);for(var o=0;o<e;o++){t[o]=new Uint8Array(e);for(var n=0;n<e;n++)t[o][n]=0<this.adjacencyMatrix[o][n]?1:0}return t}getEdgeList(){let e=this.adjacencyMatrix.length,t=[];for(var o=0;o<e-1;o++)for(var n=o;n<e;n++)this.adjacencyMatrix[o][n]!==Infinity&&t.push([o,n,this.adjacencyMatrix[o][n]]);return t}forceLayout(e=1e3,t=1e3,s=1.5,a=.01,c=1e3,l=1){var m=Math.sign;let p=this.distanceMatrix.slice(),u=p.length,d=new Int16Array(u);for(var g=0;g<u;g++)d[g]=this.adjacencyMatrix[g].reduce((e,t)=>t===Infinity?e:++e,0);for(var g=0;g<u;g++)for(var i=0;i<u;i++)p[g][i]=r(p[g][i],s);let f=0;for(var g=0;g<u;g++)for(var i=0;i<u;i++)p[g][i]>f&&(f=p[g][i]);for(var g=0;g<u;g++)for(var i=0;i<u;i++)p[g][i]/=f;let x=new Float32Array(u),h=new Float32Array(u),v=new Float32Array(u),y=new Float32Array(u);for(var g=0;g<u;g++)v[g]=Math.random()*e,y[g]=Math.random()*e;for(var b=0;b<t;b++){for(var g=0;g<u-1;g++)for(var i=g+1;i<u;i++){if(p[g][i]===Infinity)continue;let t=v[g]-v[i],o=y[g]-y[i],s=n(r(t,2)+r(o,2));0===s&&(s=.01),t/=s,o/=s;let c=a*(p[g][i]*e-s);this.adjacencyMatrix[g][i]!==Infinity&&(c*=u),x[g]+=c*t,h[g]+=c*o,x[i]+=-c*t,h[i]+=-c*o}for(var g=0;g<u-1;g++)for(var i=g;i<u;i++)for(var i=g;i<u;i++){if(this.adjacencyMatrix[g][i]!==Infinity)continue;let e=v[g]-v[i],t=y[g]-y[i],o=r(e,2)+r(t,2),s=n(o);0===s&&(s=.01),0===o&&(o=.05),e/=s,t/=s;let a=c/o;x[g]+=a*e,h[g]+=a*t,x[i]+=-a*e,h[i]+=-a*t}for(var g=0;g<u;g++)x[g]=m(x[g])*n(o(x[g])),h[g]=m(h[g])*n(o(h[g])),v[g]+=x[g],y[g]+=h[g];for(var g=0;g<u;g++)x[g]=0,h[g]=0}let P=0,N=0;for(var g=0;g<u;g++)v[g]*=l,y[g]*=l,P+=v[g],N+=y[g];P/=u,N/=u;for(var g=0;g<u;g++)v[g]-=P-e/2,y[g]-=N-e/2;let A=Array(u);for(var g=0;g<u;g++)A[g]=[v[g],y[g]];return[A,this.getEdgeList()]}kkLayout(e=500,t=!1,o=!1,s=!1){let c=this.distanceMatrix,m=this.distanceMatrix.length;if(t)for(var d=0;d<m;d++)for(var i=0;i<m;i++)c[d][i]!==Infinity&&(c[d][i]=Math.log(c[d][i]));if(s)for(var d=0;d<m;d++)for(var i=0;i<m;i++)c[d][i]!==Infinity&&0!==c[d][i]&&(c[d][i]=r(c[d][i],2));if(s){let e=0;for(var d=0;d<m;d++)for(var i=0;i<m;i++)c[d][i]>e&&c[d][i]!==Infinity&&(e=c[d][i]);for(var d=0;d<m;d++)for(var i=0;i<m;i++)c[d][i]!==Infinity&&(c[d][i]/=e)}let p=2*Math.PI/m,f=0,a=new Float32Array(m),u=new Float32Array(m),g=Array(m),x=e/(2*this.diameter);console.log("l: "+x),console.log("diameter: "+this.diameter),e/=2;for(var d=m;d--;)a[d]=e+Math.cos(f)*e,u[d]=e+Math.sin(f)*e,g[d]=!1,f+=p;let l=Array(m);for(d=m;d--;){l[d]=Array(m);for(var i=m;i--;)l[d][i]=x*c[d][i]}let h=Array(m);for(d=m;d--;){h[d]=Array(m);for(var i=m;i--;)h[d][i]=50*r(c[d][i],-2)}let v=Array(m),y=new Float32Array(m),b=new Float32Array(m);for(d=m;d--;)v[d]=Array(m);d=m;for(let r,i,c,p,f,g,x;d--;){r=a[d],i=u[d],c=0,p=0;for(let e=m;e--;)d!==e&&(f=a[e],g=u[e],x=1/n((r-f)*(r-f)+(i-g)*(i-g)),v[d][e]=[h[d][e]*(r-f-l[d][e]*(r-f)*x)||0,h[d][e]*(i-g-l[d][e]*(i-g)*x)||0],v[e][d]=v[d][e],c+=v[d][e][0],p+=v[d][e][1]);y[d]=c,b[d]=p}let P=function(e){return[y[e]*y[e]+b[e]*b[e],y[e],b[e]]},N=function(){let e=0,t=0,o=0,n=0;for(d=m;d--;){let[r,s,i]=P(d);r>e&&(e=r,t=d,o=s,n=i)}return[t,e,o,n]},A=function(e,t,o){let s=0,i=0,c=0,p=a[e],f=u[e],g=l[e],x=h[e];for(d=m;d--;){if(d===e)continue;let t=a[d],o=u[d],n=g[d],l=x[d],h=(p-t)*(p-t),m=1/r(h+(f-o)*(f-o),1.5);s+=l*(1-n*(f-o)*(f-o)*m)||0,i+=l*(1-n*h*m)||0,c+=l*(n*(p-t)*(f-o)*m)||0}0==s&&(s=.1),0==i&&(i=.1),0==c&&(c=.1);let P=t/s+o/c;P/=c/s-i/c;let N=-(c*P+t)/s;a[e]+=N,u[e]+=P;let A=v[e];t=0,o=0,p=a[e],f=u[e];let _,S,C,E,M;for(d=m;d--;)e!==d&&(_=a[d],S=u[d],C=A[d][0],E=A[d][1],M=1/n((p-_)*(p-_)+(f-S)*(f-S)),N=x[d]*(p-_-g[d]*(p-_)*M)||0,P=x[d]*(f-S-g[d]*(f-S)*M)||0,A[d]=[N,P],t+=N,o+=P,y[d]+=N-C,b[d]+=P-E);y[e]=t,b[e]=o},_=1e9,S=0,C=0,E=0,M=0,z=0,T=0;for(;_>.1&&6e3>z;)for(z++,[S,_,C,E]=N(),M=_,T=0;M>.1&&10>T;)T++,A(S,C,E),[M,C,E]=P(S);let F=Array(m);for(d=m;d--;)F[d]=[a[d],u[d]];return[F,this.getEdgeList()]}getDiameter(){let e=0;for(var t=0;t<this.distanceMatrix.length-1;t++)for(var o=t;o<this.distanceMatrix.length;o++)this.distanceMatrix[t][o]>e&&this.distanceMatrix[t][o]<Infinity&&(e=this.distanceMatrix[t][o]);return e}getDistanceMatrix(){let e=this.adjacencyMatrix.length,t=Array(e);for(var o=0;o<e;o++)t[o]=new Float32Array(e),t[o].fill(Infinity);for(var o=0;o<e;o++)for(var n=0;n<e;n++)this.adjacencyMatrix[o][n]<Infinity&&(t[o][n]=this.adjacencyMatrix[o][n]);for(var r=0;r<e;r++)for(var o=0;o<e;o++)for(var n=0;n<e;n++)t[o][n]>t[o][r]+t[r][n]&&(t[o][n]=t[o][r]+t[r][n]);return t}static fromEdgeList(e,t=!1){let o=0;for(var n=0;n<e.length;n++)e[n][0]>o&&(o=e[n][0]),e[n][1]>o&&(o=e[n][1]);if(o++,t){let t=0;for(var n=0;n<e.length;n++)e[n][2]>t&&(t=e[n][2]);t++;for(var n=0;n<e.length;n++)e[n][2]=t-e[n][2]}let r=Array(o);for(var n=0;n<o;n++)r[n]=new Float32Array(o),r[n].fill(0);for(var n=0;n<e.length;n++){let t=e[n];r[t[0]][t[1]]=t[2],r[t[1]][t[0]]=t[2]}return new s(r)}}t.exports=s},{}],16:[function(e,t){"use strict";const o=e("../Math/Vector3f"),n=e("../Math/Quaternion"),r=e("../Math/Matrix3f"),s=e("../Math/Matrix4f");class i{constructor(){this.type="Node",this.id=i.createGUID(),this.isVisible=!0,this.position=new o(0,0,0),this.rotation=new n(0,0,0,0),this.scale=new o(1,1,1),this.up=new o(0,1,0),this.normalMatrix=new r,this.modelMatrix=new s,this.isStale=!1,this.children=[],this.parent=null}applyMatrix(e){return this.modelMatrix.multiplyB(e),this}getUpVector(){let e=new o(0,1,0);return e.applyQuaternion(this.rotation)}getForwardVector(){let e=new o(0,0,1);return e.applyQuaternion(this.rotation)}getRightVector(){let e=new o(1,0,0);return e.applyQuaternion(this.rotation)}translateOnAxis(e,t){let n=new o(e.components[0],e.components[1],e.components[2]);return n.applyQuaternion(this.rotation),n.multiplyScalar(t),this.position.add(n),this}translateX(e){return this.position.components[0]+=e,this}translateY(e){return this.position.components[1]+=e,this}translateZ(e){return this.position.components[2]+=e,this}setTranslation(e){return this.position=e,this}setRotation(e,t){return this.rotation.setFromAxisAngle(e,t),this}rotate(e,t){let o=new n(e,t);return this.rotation.multiplyA(o),this}rotateX(e){return this.rotation.rotateX(e),this}rotateY(e){return this.rotation.rotateY(e),this}rotateZ(e){return this.rotation.rotateZ(e),this}getRotationMatrix(){return this.rotation.toRotationMatrix()}update(){return this.modelMatrix.compose(this.position,this.rotation,this.scale),this.isStale=!0,this}getModelMatrix(){return this.modelMatrix.entries}static createGUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=0|16*Math.random(),o="x"==e?t:8|3&t;return o.toString(16)})}}t.exports=i},{"../Math/Matrix3f":37,"../Math/Matrix4f":38,"../Math/Quaternion":40,"../Math/Vector3f":45}],17:[function(e,t){"use strict";var o=Math.round;const n=e("../Shaders"),r=e("./Effect"),s=e("../Math/Vector3f"),i=e("./Color"),a=e("../Utils/Utils"),c=e("./Geometry"),l=e("../Controls/ControlsBase"),m=e("../Controls/OrbitalControls"),d=e("../Cameras/CameraBase"),p=e("../Cameras/OrthographicCamera");t.exports=class{constructor(e,t){this.defaults={antialiasing:!0,verbose:!1,fpsElement:document.getElementById("fps"),clearColor:i.fromHex("#000000"),clearDepth:1,radius:500,center:new s(0,0,0),enableDepthTest:!0,enableTransparency:!1},this.opts=a.extend(!0,this.defaults,t),this.canvas=document.getElementById(e),this.webgl2=!0,this.parent=this.canvas.parentElement,this.fps=0,this.fpsCount=0,this.maxFps=1e3/30,this.devicePixelRatio=this.getDevicePixelRatio(),this.camera=new p(this.getWidth()/-2,this.getWidth()/2,this.getHeight()/2,this.getHeight()/-2),this.geometries={},this.ready=!1,this.gl=null,this.render=function(){},this.effect=null,this.lastTiming=performance.now(),this.disableContextMenu();let o=this;o.init();let n=t.center?t.center:new s(0,0,0);this.controls=new m(o,this.opts.radius||500,n)}init(){let e=this,t={antialias:this.opts.antialiasing};if(this.gl=this.canvas.getContext("webgl2",t)||this.canvas.getContext("experimental-webgl2"),this.gl||(this.webgl2=!1,this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t)),!this.gl)return void console.error("Could not initialize the WebGL context.");let o=this.gl;if(this.opts.verbose){let e=o.getContextAttributes().antialias,t=o.getParameter(o.SAMPLES);console.info("Antialiasing: "+e+" ("+t+"x)");let n=o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT),r=0!=n.precision;console.info("High precision support: "+r),console.info("WebGL2 supported: "+this.webgl2)}let n="OES_standard_derivatives",s=o.getExtension(n);null===s&&console.warn("Could not load extension: "+n+".");let i="WEBGL_draw_buffers",a=o.getExtension(i);null===a&&console.warn("Could not load extension: "+i+".");let c="WEBGL_depth_texture",l=o.getExtension(c);null===l&&console.warn("Could not load extension: "+c+".");let m="EXT_frag_depth",d=o.getExtension(m);null===d&&console.warn("Could not load extension: "+m+"."),this.setClearColor(this.opts.clearColor),(o.clearDepth(this.opts.clearDepth),this.opts.enableTransparency?(o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),o.disable(o.DEPTH_TEST)):this.opts.enableDepthTest&&(o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),this.opts.verbose&&console.log("enable depth test"))),setTimeout(function(){e.updateViewport(0,0,e.getWidth(),e.getHeight())},1e3),this.updateViewport(0,0,e.getWidth(),e.getHeight()),window.addEventListener("resize",function(){let t=e.getWidth(),o=e.getHeight();e.updateViewport(0,0,t,o)}),this.effect=new r(this,"fxaaEffect"),this.ready=!0,this.animate()}disableContextMenu(){this.canvas.addEventListener("contextmenu",function(t){if(2===t.button)return t.preventDefault(),!1})}setClearColor(e){this.opts.clearColor=e;let t=this.opts.clearColor.components;this.gl.clearColor(t[0],t[1],t[2],t[3])}getWidth(){return this.canvas.offsetWidth}getHeight(){return this.canvas.offsetHeight}updateViewport(e,t,o,n){this.canvas.width=o,this.canvas.height=n,this.gl.viewport(e,t,o,n),this.camera.updateViewport(o,n),this.camera.updateProjectionMatrix(),this.effect=new r(this,"fxaaEffect"),this.effect.shader.uniforms.resolution.setValue([o,n])}animate(){let e=this;if(setTimeout(function(){requestAnimationFrame(function(){e.animate()})},this.maxFps),this.opts.fpsElement){let e=performance.now(),t=e-this.lastTiming;this.lastTiming=e,10>this.fpsCount?(this.fps+=o(1e3/t),this.fpsCount++):(this.opts.fpsElement.innerHTML=o(this.fps/this.fpsCount),this.fpsCount=0,this.fps=0)}this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.render(this.camera,this.geometries),this.camera.isProjectionMatrixStale=!1,this.camera.isViewMatrixStale=!1}createGeometry(e,t){let o=n[t].clone();o.init(this.gl,this.webgl2);let r=new c(e,this.gl,o);return this.geometries[e]=r,r}setMaxFps(e){this.maxFps=1e3/e}getDevicePixelRatio(){return window.devicePixelRatio||1}}},{"../Cameras/CameraBase":2,"../Cameras/OrthographicCamera":3,"../Controls/ControlsBase":6,"../Controls/OrbitalControls":8,"../Math/Vector3f":45,"../Shaders":57,"../Utils/Utils":62,"./Color":11,"./Effect":13,"./Geometry":14}],18:[function(e,t){"use strict";const o=e("./Uniform"),n=e("../Math/Matrix4f");class r{constructor(e,t,r,s,i){this.name=e,this.uniforms=r||{},this.vertexShader=s||[],this.fragmentShader=i||[],this.glVersion=t,this.gl=null,this.program=null,this.initialized=!1,this.lastTime=new Date().getTime(),this.uniforms.modelViewMatrix=new o("modelViewMatrix",new n().entries,"float_mat4"),this.uniforms.projectionMatrix=new o("projectionMatrix",new n().entries,"float_mat4")}clone(){return new r(this.name,this.glVersion,this.uniforms,this.vertexShader,this.fragmentShader)}getVertexShaderCode(){return this.vertexShader.join("\n")}getFragmentShaderCode(){return this.fragmentShader.join("\n")}getVertexShader(e,t=!1){let o=e.createShader(e.VERTEX_SHADER),n="";if(!t&&2===this.glVersion)throw"The shader expects WebGL 2.0";else 2===this.glVersion&&(n+="#version 300 es\n");return n+="uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n\n"+this.getVertexShaderCode(),e.shaderSource(o,n),e.compileShader(o),r.showCompilationInfo(e,o,this.name,"Vertex Shader"),o}getFragmentShader(e,t=!1){let o=e.createShader(e.FRAGMENT_SHADER),n="";if(!t&&2===this.glVersion)throw"The shader expects WebGL 2.0";else 2===this.glVersion&&(n+="#version 300 es\n");return n+="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n"+this.getFragmentShaderCode(),e.shaderSource(o,n),e.compileShader(o),r.showCompilationInfo(e,o,this.name,"Fragment Shader"),o}init(e,t=!1){this.gl=e,this.program=this.gl.createProgram();let o=this.getVertexShader(this.gl,t),n=this.getFragmentShader(this.gl,t);return o&&n?(this.gl.attachShader(this.program,o),this.gl.attachShader(this.program,n),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)?void(this.initialized=!0):(console.error("Could not link program.\nVALIDATE_STATUS: "+this.gl.getProgramParameter(this.program,this.gl.VALIDATE_STATUS)+"\nERROR: "+this.gl.getError()),null)):(console.error("Failed to create the fragment or the vertex shader."),null)}updateUniforms(){if(this.uniforms.time){let e=this.uniforms.time,t=new Date().getTime();e.value+=t-this.lastTime,this.lastTime=t,o.Set(this.gl,this.program,e),e.stale=!1}for(let e in this.uniforms){let t=this.uniforms[e];t.stale&&o.Set(this.gl,this.program,t)}}use(){this.gl.useProgram(this.program),this.updateUniforms()}static showCompilationInfo(e,t,o,n){n=n||"Shader",!1===e.getShaderParameter(t,e.COMPILE_STATUS)&&console.error(n+" "+o+" did not compile."),""!==e.getShaderInfoLog(t)&&console.warn(n+" "+o+" info log: "+e.getShaderInfoLog(t))}}t.exports=r},{"../Math/Matrix4f":38,"./Uniform":20}],19:[function(e,t){"use strict";var o=Math.pow;class n{constructor(e,t){this.tree=e,this.weights=t}layout(){let e=0,t=new Uint8Array(this.tree.length),n=new Float32Array(this.tree.length),r=new Float32Array(this.tree.length),s=[e];t[e]=1;let a=null;for(n[e]=20,r[e]=10;0<s.length;){a=s.shift();let e=0;for(var c=0;c<this.tree[a].length;c++){let l=this.tree[a][c];if(0===t[l]){n[l]=n[a]+5*this.weights[a][c],r[l]=r[a]+10*e++*this.weights[a][c];for(var i=0;i<length;i++){if(0===t[i])continue;let e=o(n[i]-n[l],2)+o(r[i]-r[l],2),s=Math.sqrt(e)}t[l]=1,s.push(l)}}}let l=Array(this.tree.length);for(var c=0;c<this.tree.length;c++)l[c]=[n[c],r[c]];return l}static fromEdgeList(e){let t=0;for(var o=0;o<e.length;o++)e[o][0]>t&&(t=e[o][0]),e[o][1]>t&&(t=e[o][1]);t++;let r=Array(t),s=Array(t);for(var o=0;o<t;o++)r[o]=[],s[o]=[];for(var o=0;o<e.length;o++)r[e[o][0]].push(e[o][1]),r[e[o][1]].push(e[o][0]),s[e[o][0]].push(e[o][2]),s[e[o][1]].push(e[o][2]);return new n(r,s)}}t.exports=n},{}],20:[function(e,t){"use strict";t.exports=class{constructor(e,t,o){this.name=e,this.value=t,this.type=o,this.stale=!0}setValue(e){this.value=e,this.stale=!0}static Set(e,t,o){let n=e.getUniformLocation(t,o.name);"int"===o.type?e.uniform1i(n,o.value):"int_vec2"===o.type?e.uniform2iv(n,o.value):"int_vec3"===o.type?e.uniform3iv(n,o.value):"int_vec4"===o.type?e.uniform4iv(n,o.value):"int_array"===o.type?e.uniform1iv(n,o.value):"float"===o.type?e.uniform1f(n,o.value):"float_vec2"===o.type?e.uniform2fv(n,o.value):"float_vec3"===o.type?e.uniform3fv(n,o.value):"float_vec4"===o.type?e.uniform4fv(n,o.value):"float_array"===o.type?e.uniform1fv(n,o.value):"float_mat2"===o.type?e.uniformMatrix2fv(n,!1,o.value):"float_mat3"===o.type?e.uniformMatrix3fv(n,!1,o.value):"float_mat4"===o.type&&e.uniformMatrix4fv(n,!1,o.value),o.stale=!0}}},{}],21:[function(e,t){"use strict";const o=e("./Attribute"),n=e("./Color"),r=e("./DrawModes"),s=e("./Effect"),i=e("./Geometry"),a=e("./Graph"),c=e("./Node"),l=e("./Renderer"),m=e("./Shader"),d=e("./Tree"),p=e("./Uniform");t.exports={Attribute:o,Color:n,DrawModes:r,Effect:s,Geometry:i,Graph:a,Node:c,Renderer:l,Shader:m,Tree:d,Uniform:p}},{"./Attribute":10,"./Color":11,"./DrawModes":12,"./Effect":13,"./Geometry":14,"./Graph":15,"./Node":16,"./Renderer":17,"./Shader":18,"./Tree":19,"./Uniform":20}],22:[function(e,t){"use strict";e("../Core/Geometry");t.exports=class{constructor(e,t){this.type="Lore.FilterBase",this.geometry=null,this.attribute=e,this.attributeIndex=t,this.active=!1}getGeometry(){return this.geometry}setGeometry(e){this.geometry=e}filter(){}reset(){}static isVisible(e,t){return 0<e.attributes.color.data[3*t+2]}}},{"../Core/Geometry":14}],23:[function(e,t){"use strict";var o=Math.abs;const n=e("./FilterBase");t.exports=class extends n{constructor(e,t,o,n){super(e,t),this.min=o,this.max=n}getMin(){return this.min}setMin(e){this.min=e}getMax(){return this.max}setMax(e){this.max=e}filter(){let e=this.geometry.attributes[this.attribute];for(let t=0;t<e.data.length;t+=e.attributeLength){let n=e.data[t+this.attributeIndex],r=this.geometry.attributes.color.data[t+2];this.geometry.attributes.color.data[t+2]=n>this.max||n<this.min?-o(r):o(r)}this.geometry.updateAttribute("color")}reset(){let e=this.geometry.attributes[this.attribute];for(let t=0,n;t<e.data.length;t+=e.attributeLength)n=this.geometry.attributes.color.data[t+2],this.geometry.attributes.color.data[t+2]=o(n);this.geometry.updateAttribute("color")}}},{"./FilterBase":22}],24:[function(e,t){"use strict";const o=e("./FilterBase"),n=e("./InRangeFilter");t.exports={FilterBase:o,InRangeFilter:n}},{"./FilterBase":22,"./InRangeFilter":23}],25:[function(e,t){"use strict";const o=e("../Core/DrawModes"),n=e("./HelperBase"),r=e("../Utils/Utils");class s extends n{constructor(e,t,n,i,a){super(e,n,i);let l=new Float32Array(3*(24*t.length)),m=new Float32Array(3*(24*t.length)),c=0;for(let o=0;o<t.length;o++){let e=t[0],o=e.center.components[0],n=e.center.components[1],s=e.center.components[2],i=e.radius,r=[o-i,n-i,s-i],a=[o-i,n-i,s+i],m=[o-i,n+i,s-i],d=[o-i,n+i,s+i],p=[o+i,n-i,s-i],f=[o+i,n-i,s+i],u=[o+i,n+i,s-i],g=[o+i,n+i,s+i];l[c++]=r[0],l[c++]=r[1],l[c++]=r[2],l[c++]=a[0],l[c++]=a[1],l[c++]=a[2],l[c++]=r[0],l[c++]=r[1],l[c++]=r[2],l[c++]=m[0],l[c++]=m[1],l[c++]=m[2],l[c++]=r[0],l[c++]=r[1],l[c++]=r[2],l[c++]=p[0],l[c++]=p[1],l[c++]=p[2],l[c++]=a[0],l[c++]=a[1],l[c++]=a[2],l[c++]=d[0],l[c++]=d[1],l[c++]=d[2],l[c++]=a[0],l[c++]=a[1],l[c++]=a[2],l[c++]=f[0],l[c++]=f[1],l[c++]=f[2],l[c++]=m[0],l[c++]=m[1],l[c++]=m[2],l[c++]=d[0],l[c++]=d[1],l[c++]=d[2],l[c++]=m[0],l[c++]=m[1],l[c++]=m[2],l[c++]=u[0],l[c++]=u[1],l[c++]=u[2],l[c++]=d[0],l[c++]=d[1],l[c++]=d[2],l[c++]=g[0],l[c++]=g[1],l[c++]=g[2],l[c++]=p[0],l[c++]=p[1],l[c++]=p[2],l[c++]=f[0],l[c++]=f[1],l[c++]=f[2],l[c++]=p[0],l[c++]=p[1],l[c++]=p[2],l[c++]=u[0],l[c++]=u[1],l[c++]=u[2],l[c++]=f[0],l[c++]=f[1],l[c++]=f[2],l[c++]=g[0],l[c++]=g[1],l[c++]=g[2],l[c++]=u[0],l[c++]=u[1],l[c++]=u[2],l[c++]=g[0],l[c++]=g[1],l[c++]=g[2]}this.opts=r.extend(!0,s.defaults,a),this.geometry.setMode(o.lines),this.setAttribute("position",l),this.setAttribute("color",m)}}t.exports=s},{"../Core/DrawModes":12,"../Utils/Utils":62,"./HelperBase":27}],26:[function(e,t){"use strict";const o=e("../Core/Color"),n=e("./HelperBase"),r=e("../Math/Vector3f"),s=e("../Utils/Utils"),i=e("../Core/DrawModes");t.exports=class extends n{constructor(e,t,n,a){super(e,t,n),this.defaults={position:new r(0,0,0),axis:{x:{length:50,color:o.fromHex("#222222")},y:{length:50,color:o.fromHex("#222222")},z:{length:50,color:o.fromHex("#222222")}},ticks:{enabled:!0,x:{count:10,length:5,offset:new r(0,0,0),color:o.fromHex("#1f1f1f")},y:{count:10,length:5,offset:new r(0,0,0),color:o.fromHex("#1f1f1f")},z:{count:10,length:5,offset:new r(0,0,0),color:o.fromHex("#1f1f1f")}},box:{enabled:!0,x:{color:o.fromHex("#222222")},y:{color:o.fromHex("#222222")},z:{color:o.fromHex("#222222")}}},this.opts=s.extend(!0,this.defaults,a),this.geometry.setMode(i.lines),this.init()}init(){let e=this.opts.position.components,t=this.opts.axis,o=[e[0],e[1],e[2],e[0]+t.x.length,e[1],e[2],e[0],e[1],e[2],e[0],e[1]+t.y.length,e[2],e[0],e[1],e[2],e[0],e[1],e[2]+t.z.length],n=t.x.color.components,r=t.y.color.components,s=t.z.color.components,a=[n[0],n[1],n[2],n[0],n[1],n[2],r[0],r[1],r[2],r[0],r[1],r[2],s[0],s[1],s[2],s[0],s[1],s[2]];if(this.opts.box.enabled){let n=this.opts.box.x.color.components,r=this.opts.box.y.color.components,s=this.opts.box.z.color.components;o.push(e[0]+t.x.length,e[1]+t.y.length,e[2]+t.z.length,e[0],e[1]+t.y.length,e[2]+t.z.length,e[0]+t.x.length,e[1],e[2]+t.z.length,e[0],e[1],e[2]+t.z.length,e[0]+t.x.length,e[1]+t.y.length,e[2],e[0],e[1]+t.y.length,e[2],e[0]+t.x.length,e[1]+t.y.length,e[2]+t.z.length,e[0]+t.x.length,e[1],e[2]+t.z.length,e[0],e[1]+t.y.length,e[2]+t.z.length,e[0],e[1],e[2]+t.z.length,e[0]+t.x.length,e[1]+t.y.length,e[2],e[0]+t.x.length,e[1],e[2],e[0]+t.x.length,e[1]+t.y.length,e[2]+t.z.length,e[0]+t.x.length,e[1]+t.y.length,e[2],e[0],e[1]+t.y.length,e[2]+t.z.length,e[0],e[1]+t.y.length,e[2],e[0]+t.x.length,e[1],e[2]+t.z.length,e[0]+t.x.length,e[1],e[2]),a.push(n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],n[0],n[1],n[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2],s[0],s[1],s[2],s[0],s[1],s[2],s[0],s[1],s[2],s[0],s[1],s[2],s[0],s[1],s[2],s[0],s[1],s[2])}if(this.opts.ticks.enabled){let n=this.opts.ticks.x,r=t.x.length/n.count,s=this.opts.ticks.y,c=t.y.length/s.count,l=this.opts.ticks.z,m=t.z.length/l.count,d=e[0],p=n.color.components;for(let t=0;t<n.count-1;t++)d+=r,o.push(d+n.offset.components[0],e[1]+n.offset.components[1],e[2]+n.offset.components[2],d+n.offset.components[0],e[1]+n.offset.components[1]+n.length,e[2]+n.offset.components[2]),a.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[0];for(let t=0;t<n.count-1;t++)d+=r,o.push(d+n.offset.components[0],e[1]+n.offset.components[1],e[2]+n.offset.components[2],d+n.offset.components[0],e[1]+n.offset.components[1],e[2]+n.offset.components[2]+n.length),a.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[1],p=s.color.components;for(let t=0;t<s.count-1;t++)d+=c,o.push(e[0]+n.offset.components[0],d+n.offset.components[1],e[2]+n.offset.components[2],e[0]+n.offset.components[0]+n.length,d+n.offset.components[1],e[2]+n.offset.components[2]),a.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[1];for(let t=0;t<s.count-1;t++)d+=c,o.push(e[0]+n.offset.components[0],d+n.offset.components[1],e[2]+n.offset.components[2],e[0]+n.offset.components[0],d+n.offset.components[1],e[2]+n.offset.components[2]+n.length),a.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[2],p=l.color.components;for(let t=0;t<l.count-1;t++)d+=m,o.push(e[0]+n.offset.components[0],e[1]+n.offset.components[1],d+n.offset.components[2],e[0]+n.offset.components[0],e[1]+n.offset.components[1]+n.length,d+n.offset.components[2]),a.push(p[0],p[1],p[2],p[0],p[1],p[2]);d=e[2];for(let t=0;t<l.count-1;t++)d+=m,o.push(e[0]+n.offset.components[0],e[1]+n.offset.components[1],d+n.offset.components[2],e[0]+n.offset.components[0]+n.length,e[1]+n.offset.components[1],d+n.offset.components[2]),a.push(p[0],p[1],p[2],p[0],p[1],p[2])}this.setAttribute("position",new Float32Array(o)),this.setAttribute("color",new Float32Array(a))}}},{"../Core/Color":11,"../Core/DrawModes":12,"../Math/Vector3f":45,"../Utils/Utils":62,"./HelperBase":27}],27:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Geometry"),r=e("../Core/Node"),s=e("../Shaders");t.exports=class extends r{constructor(e,t,o){super(),this.renderer=e,this.shader=s[o].clone(),this.geometry=this.renderer.createGeometry(t,o)}setAttribute(e,t){this.geometry.addAttribute(e,t)}getAttribute(e){return this.geometry.attributes[e].data}updateAttribute(e,t,o){let n=this.geometry.attributes[e],r=t*n.attributeLength;for(let s=0;s<n.attributeLength;s++)n.data[r+s]=o[s]||n.data[r+s];n.stale=!0}updateAttributeAll(e,t){let o=this.geometry.attributes[e];for(let n=0;n<o.data.length;n++)o.data[n]=t[n];o.stale=!0}draw(){this.geometry.draw(this.renderer)}destruct(){}}},{"../Core/Geometry":14,"../Core/Node":16,"../Core/Shader":18,"../Shaders":57}],28:[function(e,t){"use strict";const o=e("./HelperBase"),n=e("./PointHelper"),r=e("../Spice/Octree"),s=e("../Spice/Raycaster"),a=e("../Core/DrawModes"),i=e("../Utils/Utils"),c=e("../Math/Vector3f"),l=e("../Spice/AABB"),m=e("../Math/Matrix4f"),d=e("../Filters/FilterBase"),p=e("../Math/Ray");t.exports=class extends o{constructor(e,t,o,n,r){super(e,t,o),this.defaults={visualize:!1,multiSelect:!0},this.opts=i.extend(!0,this.defaults,r),this._eventListeners={},this.target=n,this.renderer=e,this.octree=this.target.octree,this.raycaster=new s,this.hovered=null,this.selected=[];let a=this;this._dblclickHandler=function(t){if(!(t.e.mouse.state.middle||t.e.mouse.state.right)){let e=t.e.mouse.normalizedPosition,o=a.getIntersections(e);if(0<o.length){if(a.selectedContains(o[0].index))return;a.addSelected(o[0])}}},e.controls.addEventListener("dblclick",this._dblclickHandler),this._mousemoveHandler=function(t){if(!(t.e.mouse.state.left||t.e.mouse.state.middle||t.e.mouse.state.right)){let o=t.e.mouse.normalizedPosition,n=a.getIntersections(o);if(0<n.length){if(a.hovered&&a.hovered.index===n[0].index)return;a.hovered=n[0],a.hovered.screenPosition=a.renderer.camera.sceneToScreen(n[0].position,e),a.raiseEvent("hoveredchanged",{e:a.hovered})}else a.hovered=null,a.raiseEvent("hoveredchanged",{e:null})}},e.controls.addEventListener("mousemove",this._mousemoveHandler),this._zoomchangedHandler=function(e){a.setPointSizeFromZoom(e)},e.controls.addEventListener("zoomchanged",this._zoomchangedHandler),this._updatedHandler=function(){for(let t=0;t<a.selected.length;t++)a.selected[t].screenPosition=a.renderer.camera.sceneToScreen(a.selected[t].position,e);a.hovered&&(a.hovered.screenPosition=a.renderer.camera.sceneToScreen(a.hovered.position,e)),a.raiseEvent("updated")},e.controls.addEventListener("updated",this._updatedHandler),this.init()}init(){"centers"===this.opts.visualize?this.drawCenters():"cubes"===this.opts.visualize?this.drawBoxes():this.geometry.isVisible=!1,this.setPointSizeFromZoom(1)}setPointSizeFromZoom(e){let t=this.target.setPointSize(e+.1);this.setThreshold(t)}getScreenPosition(e){let t=this.target.geometry.attributes.position.data,o=3*e,n=new c(t[o],t[o+1],t[o+2]);return this.renderer.camera.sceneToScreen(n,this.renderer)}addSelected(e){if(!isNaN(parseFloat(e))){let t=this.target.geometry.attributes.position.data,o=this.target.geometry.attributes.color.data,n=3*e;e={distance:-1,index:e,locCode:-1,position:new c(t[n],t[n+1],t[n+2]),color:o?[o[n],o[n+1],o[n+2]]:null}}let t=this.selected.length;this.opts.multiSelect?this.selected.push(e):(this.selected[0]=e,t=0),this.selected[t].screenPosition=this.renderer.camera.sceneToScreen(e.position,this.renderer),this.raiseEvent("selectedchanged",{e:this.selected})}removeSelected(e){this.selected.splice(e,1),this.raiseEvent("selectedchanged",{e:this.selected})}clearSelected(){this.selected=[],this.raiseEvent("selectedchanged",{e:this.selected})}selectedContains(e){for(let t=0;t<this.selected.length;t++)if(this.selected[t].index===e)return!0;return!1}setHovered(e){if(this.hovered&&this.hovered.index===e)return;let t=3*e,o=this.target.geometry.attributes.position.data,n=null;"color"in this.target.geometry.attributes&&(n=this.target.geometry.attributes.color.data),this.hovered={index:e,position:new c(o[t],o[t+1],o[t+2]),color:n?[n[t],n[t+1],n[t+2]]:null},this.hovered.screenPosition=this.renderer.camera.sceneToScreen(this.hovered.position,this.renderer),this.raiseEvent("hoveredchanged",{e:this.hovered})}selectHovered(){!this.hovered||this.selectedContains(this.hovered.index)||this.addSelected({distance:this.hovered.distance,index:this.hovered.index,locCode:this.hovered.locCode,position:this.hovered.position,color:this.hovered.color})}showCenters(){this.opts.visualize="centers",this.drawCenters(),this.geometry.isVisible=!0}showCubes(){this.opts.visualize="cubes",this.drawBoxes(),this.geometry.isVisible=!0}hide(){this.opts.visualize=!1,this.geometry.isVisible=!1,this.setAttribute("position",new Float32Array([])),this.setAttribute("color",new Float32Array([]))}getIntersections(e){this.raycaster.set(this.renderer.camera,e.x,e.y);let t=this.octree.raySearch(this.raycaster),o=this.rayIntersections(t);return o.sort(function(e,t){return e.distance-t.distance}),o}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}raiseEvent(e,t={}){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}drawCenters(){this.geometry.setMode(a.points);let e=this.octree.aabbs,t=Object.keys(e).length,o=new Float32Array(3*t),n=new Float32Array(3*t),r=0;for(var s in e){let t=e[s].center.components,i=3*r;o[i]=1,o[i+1]=1,o[i+2]=1,n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],r++}this.setAttribute("position",new Float32Array(n)),this.setAttribute("color",new Float32Array(o))}drawBoxes(){this.geometry.setMode(a.lines);let e=this.octree.aabbs,t=Object.keys(e).length,o=new Float32Array(3*(24*t)),n=new Float32Array(3*(24*t));for(let e=0;e<o.length;e++)o[e]=1;let r=0;for(var s in e){let t=l.getCorners(e[s]);n[r++]=t[0][0],n[r++]=t[0][1],n[r++]=t[0][2],n[r++]=t[1][0],n[r++]=t[1][1],n[r++]=t[1][2],n[r++]=t[0][0],n[r++]=t[0][1],n[r++]=t[0][2],n[r++]=t[2][0],n[r++]=t[2][1],n[r++]=t[2][2],n[r++]=t[0][0],n[r++]=t[0][1],n[r++]=t[0][2],n[r++]=t[4][0],n[r++]=t[4][1],n[r++]=t[4][2],n[r++]=t[1][0],n[r++]=t[1][1],n[r++]=t[1][2],n[r++]=t[3][0],n[r++]=t[3][1],n[r++]=t[3][2],n[r++]=t[1][0],n[r++]=t[1][1],n[r++]=t[1][2],n[r++]=t[5][0],n[r++]=t[5][1],n[r++]=t[5][2],n[r++]=t[2][0],n[r++]=t[2][1],n[r++]=t[2][2],n[r++]=t[3][0],n[r++]=t[3][1],n[r++]=t[3][2],n[r++]=t[2][0],n[r++]=t[2][1],n[r++]=t[2][2],n[r++]=t[6][0],n[r++]=t[6][1],n[r++]=t[6][2],n[r++]=t[3][0],n[r++]=t[3][1],n[r++]=t[3][2],n[r++]=t[7][0],n[r++]=t[7][1],n[r++]=t[7][2],n[r++]=t[4][0],n[r++]=t[4][1],n[r++]=t[4][2],n[r++]=t[5][0],n[r++]=t[5][1],n[r++]=t[5][2],n[r++]=t[4][0],n[r++]=t[4][1],n[r++]=t[4][2],n[r++]=t[6][0],n[r++]=t[6][1],n[r++]=t[6][2],n[r++]=t[5][0],n[r++]=t[5][1],n[r++]=t[5][2],n[r++]=t[7][0],n[r++]=t[7][1],n[r++]=t[7][2],n[r++]=t[6][0],n[r++]=t[6][1],n[r++]=t[6][2],n[r++]=t[7][0],n[r++]=t[7][1],n[r++]=t[7][2]}this.setAttribute("position",n),this.setAttribute("color",o)}setThreshold(e){this.raycaster.threshold=e}rayIntersections(e){let t=[],o=m.invert(this.target.modelMatrix),n=new p,r=this.raycaster.threshold*this.target.getPointScale(),s=this.target.geometry.attributes.position.data,i=null;"color"in this.target.geometry.attributes&&(i=this.target.geometry.attributes.color.data);let a=this.target.getCutoff();n.copyFrom(this.raycaster.ray).applyProjection(o);let l=r;for(let o=0;o<e.length;o++){let r=e[o].index,m=e[o].locCode,p=3*r,f=new c(s[p],s[p+1],s[p+2]),u=n.distanceSqToPoint(f);if(u<l*l){let e=n.closestPointToPoint(f);e.applyProjection(this.target.modelMatrix);let o=this.raycaster.ray.source.distanceTo(e),s=d.isVisible(this.target.geometry,r);if(o<this.raycaster.near||o>this.raycaster.far||o<a||!s)continue;t.push({distance:o,index:r,locCode:m,position:f,color:i?[i[p],i[p+1],i[p+2]]:null})}}return t}destruct(){this.renderer.controls.removeEventListener("dblclick",this._dblclickHandler),this.renderer.controls.removeEventListener("mousemove",this._mousemoveHandler),this.renderer.controls.removeEventListener("zoomchanged",this._zoomchangedHandler),this.renderer.controls.removeEventListener("updated",this._updatedHandler)}}},{"../Core/DrawModes":12,"../Filters/FilterBase":22,"../Math/Matrix4f":38,"../Math/Ray":42,"../Math/Vector3f":45,"../Spice/AABB":58,"../Spice/Octree":59,"../Spice/Raycaster":60,"../Utils/Utils":62,"./HelperBase":27,"./PointHelper":29}],29:[function(e,t){"use strict";var o=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Math.max;const s=e("./HelperBase"),i=e("../Core/DrawModes"),a=e("../Core/Color"),c=e("../Utils/Utils"),l=e("../Math/Vector3f"),m=e("../Spice/AABB"),d=e("../Spice/Octree"),p=e("../Filters/FilterBase");t.exports=class extends s{constructor(e,t,r,s){super(e,t,r);this.opts=c.extend(!0,{octree:!0,octreeThreshold:500,octreeMaxDepth:8,pointScale:1,maxPointSize:100},s),this.indices=null,this.octree=null,this.geometry.setMode(i.points),this.initPointSize(),this.filters={},this.pointScale=this.opts.pointScale,this.rawPointSize=1,this.pointSize=this.rawPointSize*this.pointScale,this.dimensions={min:new l(n,n,n),max:new l(o,o,o)}}getMaxLength(e,t,o){return r(e.length,r(t.length,o.length))}getDimensions(){return this.dimensions}getCenter(){return new l((this.dimensions.max.getX()+this.dimensions.min.getX())/2,(this.dimensions.max.getY()+this.dimensions.min.getY())/2,(this.dimensions.max.getZ()+this.dimensions.min.getZ())/2)}getMaxRadius(){let e=this.getCenter();return e.subtract(this.dimensions.max).length()}setPositions(e){return this.setAttribute("position",e),this}setPositionsXYZ(e,t,o,n){let r=new Float32Array(3*n);for(var s=0;s<n;s++){let n=3*s;r[n]=e[s]||0,r[n+1]=t[s]||0,r[n+2]=o[s]||0,e[s]>this.dimensions.max.getX()&&this.dimensions.max.setX(e[s]),e[s]<this.dimensions.min.getX()&&this.dimensions.min.setX(e[s]),t[s]>this.dimensions.max.getY()&&this.dimensions.max.setY(t[s]),t[s]<this.dimensions.min.getY()&&this.dimensions.min.setY(t[s]),o[s]>this.dimensions.max.getZ()&&this.dimensions.max.setZ(o[s]),o[s]<this.dimensions.min.getZ()&&this.dimensions.min.setZ(o[s])}if(this.opts.octree){let e=m.fromPoints(r),t=new Uint32Array(n);for(var s=0;s<n;s++)t[s]=s;this.octree=new d(this.opts.octreeThreshold,this.opts.octreeMaxDepth),this.octree.build(t,r,e)}return this.setAttribute("position",r),this}setPositionsXYZHSS(e,t,o,n,r,s){let i=this.getMaxLength(e,t,o);if(this.setPositionsXYZ(e,t,o,i),"number"==typeof n&&"number"==typeof r&&"number"==typeof s)this.setHSS(n,r,s,i);else if("number"!=typeof n&&"number"!=typeof r&&"number"!=typeof s)this.setHSSFromArrays(n,r,s,i);else{if("number"==typeof n){let e=new Float32Array(i);e.fill(n),n=e}if("number"==typeof r){let e=new Float32Array(i);e.fill(r),r=e}if("number"==typeof s){let e=new Float32Array(i);e.fill(s),s=e}this.setHSSFromArrays(n,r,s,i)}return this.renderer.camera.updateProjectionMatrix(),this.renderer.camera.updateViewMatrix(),this}setRGB(e,t,o){let n=new Float32Array(3*e.length),s=this.getAttribute("color");for(let r=0,s;r<e.length;r++)s=3*r,n[s]=e[r],n[s+1]=t[r],n[s+2]=o[r];for(let c=0;c<n.length;c+=3){let e=n[c],t=n[c+1],o=n[c+2];n[c]=a.rgbToHsl(e,t,o)[0],n[c+1]=s[c+1],n[c+2]=s[c+2]}return this.updateColors(n),this}setColors(e){return this.setAttribute("color",e),this}updateColors(e){return this.updateAttributeAll("color",e),this}updateColor(e,t){return this.updateAttribute("color",e,t.components),this}setPointSize(e){this.rawPointSize=e,this.updatePointSize();let t=this.rawPointSize*this.opts.pointScale;return t>this.opts.maxPointSize?.5*(this.opts.maxPointSize/t):.5}updatePointSize(){let e=this.rawPointSize*this.opts.pointScale;this.pointSize=e>this.opts.maxPointSize?this.opts.maxPointSize:e,this.geometry.shader.uniforms.size.value=this.pointSize}getPointSize(){return this.geometry.shader.uniforms.size.value}getPointScale(){return this.opts.pointScale}setPointScale(e){return this.opts.pointScale=e,this.updatePointSize(),this}setFogDistance(){return console.warn("This function is deprecated."),this}initPointSize(){return this.setPointSize(this.renderer.camera.zoom+.1),this}getCutoff(){return this.geometry.shader.uniforms.cutoff.value}setCutoff(e){return this.geometry.shader.uniforms.cutoff.value=e,this}getHue(e){let t=this.getAttribute("color");return t[3*e]}getSaturation(e){let t=this.getAttribute("color");return t[3*e+1]}getSize(e){let t=this.getAttribute("color");return t[3*e+2]}getPosition(e){let t=this.getAttribute("position");return new l(t[3*e],t[3*e+1],t[3*e+2])}setHue(e){let t=this.getAttribute("color"),o=null,n=0;if("number"==typeof e){let n=t.length;o=new Float32Array(3*n);for(let r=0;r<3*n;r+=3)o[r]=e,o[r+1]=t[r+1],o[r+2]=t[r+2]}else{let r=e.length;o=new Float32Array(3*r);for(let s=0;s<3*r;s+=3)o[s]=e[n++],o[s+1]=t[s+1],o[s+2]=t[s+2]}this.setColors(o)}updateHue(e,t){let o=this.getAttribute("color");if(t>o.length-1)return void console.warn("The color index is out of range.");if("number"==typeof t)"number"==typeof e?this.updateColor(t,new a(e,o[t+1],o[t+2])):console.warn("The hue value cannot be an array if index is a number.");else if(!Array.isArray(t))console.warn("The type of index is not supported: "+typeof t);else if(Array.isArray(e)){if(e.length!==t.length)console.warn("Hue and index arrays have to be of the same length.");else for(var n=0;n<t.length;n++)this.updateColor(t[n],new a(e[n],o[t[n]+1],o[t[n]+2]));}else if("number"==typeof e)for(var n=0;n<t.length;n++)this.updateColor(t[n],new a(e,o[t[n]+1],o[t[n]+2]))}setSaturation(e){let t=this.getAttribute("color"),o=null,n=0;if("number"==typeof e){let n=t.length;o=new Float32Array(3*n);for(let r=0;r<3*n;r+=3)o[r]=t[r],o[r+1]=e,o[r+2]=t[r+2]}else{let r=e.length;o=new Float32Array(3*r);for(let s=0;s<3*r;s+=3)o[s]=t[s],o[s+1]=e[n++],o[s+2]=t[s+2]}this.setColors(o)}setSize(e){let t=this.getAttribute("color"),o=null,n=0;if("number"==typeof e){let n=t.length;o=new Float32Array(3*n);for(let r=0;r<3*n;r+=3)o[r]=t[r],o[r+1]=t[r+1],o[r+2]=e}else{let r=e.length;o=new Float32Array(3*r);for(let s=0;s<3*r;s+=3)o[s]=t[s],o[s+1]=t[s+1],o[s+2]=e[n++]}this.setColors(o)}setHSS(e,t,o,n){let r=new Float32Array(3*n);for(let s=0;s<3*n;s+=3)r[s]=e,r[s+1]=t,r[s+2]=o;this.setColors(r)}setHSSFromArrays(e,t,o,n){let r=new Float32Array(3*n),s=0;if(e.length!==n&&t.length!==n&&o.length!==n)throw"Hue, saturation and size have to be arrays of length \"length\" ("+n+").";for(let a=0;a<3*n;a+=3)r[a]=e[s],r[a+1]=t[s],r[a+2]=o[s],s++;this.setColors(r)}addFilter(e,t){return t.setGeometry(this.geometry),this.filters[e]=t,this}removeFilter(e){return delete this.filters[e],this}getFilter(e){return this.filters[e]}}},{"../Core/Color":11,"../Core/DrawModes":12,"../Filters/FilterBase":22,"../Math/Vector3f":45,"../Spice/AABB":58,"../Spice/Octree":59,"../Utils/Utils":62,"./HelperBase":27}],30:[function(e,t){"use strict";var o=Math.max;const n=e("./HelperBase"),r=e("../Core/DrawModes"),s=e("../Utils/Utils");t.exports=class extends n{constructor(e,t,o,n){super(e,t,o),this.defaults={pointScale:1,maxPointSize:100},this.opts=s.extend(!0,this.defaults,n),this.indices=null,this.geometry.setMode(r.lines),this.initPointSize(),this.filters={}}getMaxLength(e,t,n){return o(e.length,o(t.length,n.length))}setPositions(e){this.setAttribute("position",e)}setPositionsXYZ(e,t,o,n){let r=new Float32Array(3*n);for(let s=0,i;s<n;s++)i=3*s,r[i]=e[s]||0,r[i+1]=t[s]||0,r[i+2]=o[s]||0;this.setAttribute("position",r)}setPositionsXYZHSS(e,t,o,n,r,s){let i=this.getMaxLength(e,t,o);this.setPositionsXYZ(e,t,o,i),this.setHSS(n,r,s,i)}setColors(e){this.setAttribute("color",e)}updateColors(e){this.updateAttributeAll("color",e)}updateColor(e,t){this.updateAttribute("color",e,t.components)}setPointSize(e){e*this.opts.pointScale>this.opts.maxPointSize||(this.geometry.shader.uniforms.size.value=e*this.opts.pointScale)}getPointSize(){return this.geometry.shader.uniforms.size.value}setFogDistance(){console.warn("This function is deprecated.")}initPointSize(){this.geometry.shader.uniforms.size.value=this.renderer.camera.zoom*this.opts.pointScale}getCutoff(){return this.geometry.shader.uniforms.cutoff.value}setCutoff(e){this.geometry.shader.uniforms.cutoff.value=e}getHue(e){let t=this.getAttribute("color");return t[3*e]}setHSS(e,t,o,n){let r=new Float32Array(3*n);for(let s=0;s<3*n;s+=3)r[s]=e,r[s+1]=t,r[s+2]=o;this.setColors(r)}addFilter(e,t){t.setGeometry(this.geometry),this.filters[e]=t}removeFilter(e){delete this.filters[e]}getFilter(e){return this.filters[e]}}},{"../Core/DrawModes":12,"../Utils/Utils":62,"./HelperBase":27}],31:[function(e,t){"use strict";const o=e("./AABBHelper"),n=e("./CoordinatesHelper"),r=e("./HelperBase"),s=e("./OctreeHelper"),i=e("./PointHelper"),a=e("./TreeHelper");t.exports={AABBHelper:o,CoordinatesHelper:n,HelperBase:r,OctreeHelper:s,PointHelper:i,TreeHelper:a}},{"./AABBHelper":25,"./CoordinatesHelper":26,"./HelperBase":27,"./OctreeHelper":28,"./PointHelper":29,"./TreeHelper":30}],32:[function(e,t){"use strict";const o=e("./FileReaderBase"),n=e("../Utils/Utils");t.exports=class extends o{constructor(e,t,o=!0){super(e,o),this.defaults={separator:",",cols:[],types:[],header:!0},this.opts=n.extend(!0,this.defaults,t),this.columns={},this.headers=[],this.types=this.opts.types,this.cols=this.opts.cols}loaded(e){e=e.replace("\n\n","\n"),e=e.replace(/^\s+|\s+$/g,"");let t=e.split("\n"),o=t.length,r=!0,s=this.opts.header?1:0;if(0!==this.cols.length){if(this.types.length!==this.cols.length)throw"Types and cols must have the same number of elements.";}else if(this.types.length!==this.cols.length||0===this.types.length+this.cols.length){let e=t[s].split(this.opts.separator);this.types=[];for(let t=0;t<e.length;t++)n.isFloat(parseFloat(e[t],10))?this.types.push("Float32Array"):n.isInt(parseFloat(e[t],10))?this.types.push("Int32Array"):this.types.push("StringArray")}if(0===this.cols.length){let e=t[0].split(this.opts.separator);for(let t=0;t<e.length;t++)this.cols.push(t)}if(s){let e=t[0].split(this.opts.separator);for(let t=0;t<this.cols.length;t++)this.headers[t]=e[this.cols[t]].trim()}else for(let e=0;e<this.cols.length;e++)this.headers[e]=e;for(let n=s,i;n<o;n++){if(i=t[n].split(this.opts.separator),0==this.cols.length)for(let e=0;e<i.length;e++)this.cols.push[e];if(r){for(let e=0;e<this.cols.length;e++)this._createArray(this.headers[e],this.types[e],o-s);r=!1}for(let e=0;e<this.cols.length;e++)this.columns[this.headers[e]][n-s]=i[this.cols[e]]}return this.raiseEvent("loaded",this.columns),this}_createArray(e,t,o){return this.columns[e]="Int8Array"==t?new Int8Array(o):"Uint8Array"==t?new Uint8Array(o):"Uint8ClampedArray"==t?new Uint8ClampedArray(o):"Int16Array"==t?new Int16Array(o):"Uint16Array"==t?new Uint16Array(o):"Int32Array"==t?new Int32Array(o):"Uint32Array"==t?new Uint32Array(o):"Float32Array"==t?new Float32Array(o):"Float64Array"==t?new Float64Array(o):Array(o),this}}},{"../Utils/Utils":62,"./FileReaderBase":33}],33:[function(e,t){"use strict";const o=e("../Utils/Utils");t.exports=class{constructor(e,t=!0){this.source=e,this._eventListeners={};let n=this;t?(this.element=document.getElementById(this.source),this.element.addEventListener("click",function(){this.value=null}),this.element.addEventListener("change",function(){let e=new FileReader;e.onload=function(){n.loaded(e.result)},e.readAsBinaryString(this.files[0])})):o.jsonp(e,function(e){n.loaded(e)})}addEventListener(e,t){this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}raiseEvent(e,t){if(this._eventListeners[e])for(let o=0;o<this._eventListeners[e].length;o++)this._eventListeners[e][o](t)}loaded(){}}},{"../Utils/Utils":62}],34:[function(e,t){"use strict";const o=e("./FileReaderBase"),n=e("../Utils/Utils");t.exports=class extends o{constructor(e,t,o=!0){if(super(e,o),this.defaults={elementSeperator:"\t",valueSeparator:";",replaceNaNWith:"NaN",skipNaN:!0,types:[]},this.opts=n.extend(!0,this.defaults,t),this.types=this.opts.types,this.columns={},0===this.types.length)throw"When reading data from a file, the types have to be specified.";this.opts.types.unshift("Int32Array"),this.opts.types.unshift("Int32Array"),this.opts.types.unshift("Int32Array")}loaded(e){e=e.replace("\n\n","\n"),e=e.replace(/^\s+|\s+$/g,""),"NaN"!==this.opts.replaceNaNWith&&(e=e.replace("NaN",this.opts.replaceNaNWith));let t=e.split("\n"),o=t.length,r=t[0].split(this.opts.elementSeperator).length,s=t[0].split(this.opts.elementSeperator)[0].split(this.opts.valueSeparator).length+3;if(this.types.length!==s||0===this.types.length+s){let e=t[0].split(this.opts.valueSeparator);this.types=[];for(let t=0;t<e.length;t++)n.isFloat(parseFloat(e[t],10))?this.types.push("Float32Array"):n.isInt(parseFloat(e[t],10))?this.types.push("Int32Array"):this.types.push("StringArray")}for(var a=0;a<s;a++)this._createArray(a,this.types[a],o*r);let i=0;for(var a=0;a<o;a++){let e=t[a].split(this.opts.elementSeperator);if(0!==e.length)for(var c=0;c<r;c++){if(!e[c])continue;let t=e[c].split(this.opts.valueSeparator);if(this.opts.skipNaN){let e=!1;for(var l=0;l<t.length;l++)if(isNaN(t[l])){e=!0;break}if(e)continue}this.columns[0][i]=a,this.columns[1][i]=c,this.columns[2][i]=0;for(var l=0;l<t.length;l++)this.columns[l+3][i]=t[l];i++}}return this._resizeArrays(i),this.raiseEvent("loaded",this.columns),this}_resizeArrays(e){for(var t=0;t<this.columns.length;t++)this.columns[t]=this.columns[t].slice(0,e)}_createArray(e,t,o){return this.columns[e]="Int8Array"==t?new Int8Array(o):"Uint8Array"==t?new Uint8Array(o):"Uint8ClampedArray"==t?new Uint8ClampedArray(o):"Int16Array"==t?new Int16Array(o):"Uint16Array"==t?new Uint16Array(o):"Int32Array"==t?new Int32Array(o):"Uint32Array"==t?new Uint32Array(o):"Float32Array"==t?new Float32Array(o):"Float64Array"==t?new Float64Array(o):Array(o),this}}},{"../Utils/Utils":62,"./FileReaderBase":33}],35:[function(e,t){"use strict";const o=e("./CsvFileReader"),n=e("./FileReaderBase"),r=e("./MatrixFileReader");t.exports={CsvFileReader:o,FileReaderBase:n,MatrixFileReader:r}},{"./CsvFileReader":32,"./FileReaderBase":33,"./MatrixFileReader":34}],36:[function(e,t){"use strict";const o=e("./Core"),n=e("./Controls"),r=e("./Cameras"),s=e("./Filters"),i=e("./Helpers"),a=e("./IO"),c=e("./Math"),l=e("./Shaders"),m=e("./Spice"),d=e("./Utils").Utils;t.exports={Cameras:r,Controls:n,Core:o,Filters:s,Helpers:i,IO:a,Math:c,Shaders:l,Spice:m,Utils:d}},{"./Cameras":5,"./Controls":9,"./Core":21,"./Filters":24,"./Helpers":31,"./IO":35,"./Math":46,"./Shaders":57,"./Spice":61,"./Utils":63}],37:[function(e,t){"use strict";class o{constructor(e=new Float32Array([1,0,0,0,1,0,0,0,1])){this.entries=e}clone(){return new o(new Float32Array(this.entries))}equals(e){for(let t=0;t<this.entries.length;t++)if(this.entries[t]!==e.entries[t])return!1;return!0}}t.exports=o},{}],38:[function(e,t){"use strict";var o=Math.sqrt;const n=e("./Vector3f");class r{constructor(e=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])){this.entries=e}set(e,t,o,n,r,s,i,a,c,l,m,d,p,f,u,g){return this.entries.set([e,t,o,n,r,s,i,a,c,l,m,d,p,f,u,g]),this}setZero(){return this}multiplyA(e){let t=this.entries[0],o=this.entries[4],n=this.entries[8],r=this.entries[12],s=this.entries[1],i=this.entries[5],a=this.entries[9],c=this.entries[13],l=this.entries[2],m=this.entries[6],d=this.entries[10],p=this.entries[14],f=this.entries[3],u=this.entries[7],g=this.entries[11],x=this.entries[15],h=e.entries[0],v=e.entries[4],y=e.entries[8],b=e.entries[12],P=e.entries[1],N=e.entries[5],A=e.entries[9],_=e.entries[13],S=e.entries[2],C=e.entries[6],E=e.entries[10],M=e.entries[14],z=e.entries[3],T=e.entries[7],F=e.entries[11],L=e.entries[15];return this.entries[0]=t*h+o*P+n*S+r*z,this.entries[1]=s*h+i*P+a*S+c*z,this.entries[2]=f*h+u*P+g*S+x*z,this.entries[3]=t*v+o*N+n*C+r*T,this.entries[4]=l*h+m*P+d*S+p*z,this.entries[5]=s*v+i*N+a*C+c*T,this.entries[6]=l*v+m*N+d*C+p*T,this.entries[7]=f*v+u*N+g*C+x*T,this.entries[8]=t*y+o*A+n*E+r*F,this.entries[9]=s*y+i*A+a*E+c*F,this.entries[10]=l*y+m*A+d*E+p*F,this.entries[11]=f*y+u*A+g*E+x*F,this.entries[12]=t*b+o*_+n*M+r*L,this.entries[13]=s*b+i*_+a*M+c*L,this.entries[14]=l*b+m*_+d*M+p*L,this.entries[15]=f*b+u*_+g*M+x*L,this}multiplyB(e){let t=e.entries[0],o=e.entries[4],n=e.entries[8],r=e.entries[12],s=e.entries[1],i=e.entries[5],a=e.entries[9],c=e.entries[13],l=e.entries[2],m=e.entries[6],d=e.entries[10],p=e.entries[14],f=e.entries[3],u=e.entries[7],g=e.entries[11],x=e.entries[15],h=this.entries[0],v=this.entries[4],y=this.entries[8],b=this.entries[12],P=this.entries[1],N=this.entries[5],A=this.entries[9],_=this.entries[13],S=this.entries[2],C=this.entries[6],E=this.entries[10],M=this.entries[14],z=this.entries[3],T=this.entries[7],F=this.entries[11],L=this.entries[15];return this.entries[0]=t*h+o*P+n*S+r*z,this.entries[1]=s*h+i*P+a*S+c*z,this.entries[2]=f*h+u*P+g*S+x*z,this.entries[3]=t*v+o*N+n*C+r*T,this.entries[4]=l*h+m*P+d*S+p*z,this.entries[5]=s*v+i*N+a*C+c*T,this.entries[6]=l*v+m*N+d*C+p*T,this.entries[7]=f*v+u*N+g*C+x*T,this.entries[8]=t*y+o*A+n*E+r*F,this.entries[9]=s*y+i*A+a*E+c*F,this.entries[10]=l*y+m*A+d*E+p*F,this.entries[11]=f*y+u*A+g*E+x*F,this.entries[12]=t*b+o*_+n*M+r*L,this.entries[13]=s*b+i*_+a*M+c*L,this.entries[14]=l*b+m*_+d*M+p*L,this.entries[15]=f*b+u*_+g*M+x*L,this}scale(e){let t=e.components[0],o=e.components[1],n=e.components[2];return this.entries[0]*=t,this.entries[1]*=t,this.entries[2]*=t,this.entries[3]*=t,this.entries[4]*=o,this.entries[5]*=o,this.entries[6]*=o,this.entries[7]*=o,this.entries[8]*=n,this.entries[9]*=n,this.entries[10]*=n,this.entries[11]*=n,this}setPosition(e){return this.entries[12]=e.components[0],this.entries[13]=e.components[1],this.entries[14]=e.components[2],this}setRotation(e){let t=e.components[0],o=e.components[1],n=e.components[2],r=e.components[3],s=t+t,i=o+o,a=n+n,c=t*s,l=t*i,m=t*a,d=o*i,p=o*a,f=n*a,u=r*s,g=r*i,x=r*a;return this.entries[0]=1-(d+f),this.entries[1]=l+x,this.entries[2]=m-g,this.entries[4]=l-x,this.entries[5]=1-(c+f),this.entries[6]=p+u,this.entries[8]=m+g,this.entries[9]=p-u,this.entries[10]=1-(c+d),this.entries[3]=0,this.entries[7]=0,this.entries[11]=0,this.entries[12]=0,this.entries[13]=0,this.entries[14]=0,this.entries[15]=1,this}determinant(){let e=this.entries,t=e.entries[0],o=e.entries[4],n=e.entries[8],r=e.entries[12],s=e.entries[1],i=e.entries[5],a=e.entries[9],c=e.entries[13],l=e.entries[2],m=e.entries[6],d=e.entries[10],p=e.entries[14],f=e.entries[3],u=e.entries[7],g=e.entries[11],x=e.entries[15];return f*(r*a*m-n*c*m-r*i*d+o*c*d+n*i*p-o*a*p)+u*(t*a*p-t*c*d+r*s*d-n*s*p+n*c*l-r*a*l)+g*(t*c*m-t*i*p-r*s*m+o*s*p+r*i*l-o*c*l)+x*(-n*i*l-t*a*m+t*i*d+n*s*m-o*s*d+o*a*l)}decompose(e,t,n){let s=new r;e.set(this.entries[12],this.entries[13],this.entries[14]);let i=o(this.entries[0]*this.entries[0]+this.entries[1]*this.entries[1]+this.entries[2]*this.entries[2]),a=o(this.entries[4]*this.entries[4]+this.entries[5]*this.entries[5]+this.entries[6]*this.entries[6]),c=o(this.entries[8]*this.entries[8]+this.entries[9]*this.entries[9]+this.entries[10]*this.entries[10]),l=this.determinant();0>l&&(i=-i),n.set(i,a,c);let m=1/i,d=1/a,p=1/c;return s.entries.set(this.entries),s.entries[0]*=m,s.entries[1]*=m,s.entries[2]*=m,s.entries[4]*=d,s.entries[5]*=d,s.entries[6]*=d,s.entries[8]*=p,s.entries[9]*=p,s.entries[10]*=p,t.setFromMatrix(s),this}compose(e,t,o){return this.setRotation(t),this.scale(o),this.setPosition(e),this}invert(){let e=new r,t=this.entries;e.entries[0]=t[5]*t[10]*t[15]-t[5]*t[11]*t[14]-t[9]*t[6]*t[15]+t[9]*t[7]*t[14]+t[13]*t[6]*t[11]-t[13]*t[7]*t[10],e.entries[4]=-t[4]*t[10]*t[15]+t[4]*t[11]*t[14]+t[8]*t[6]*t[15]-t[8]*t[7]*t[14]-t[12]*t[6]*t[11]+t[12]*t[7]*t[10],e.entries[8]=t[4]*t[9]*t[15]-t[4]*t[11]*t[13]-t[8]*t[5]*t[15]+t[8]*t[7]*t[13]+t[12]*t[5]*t[11]-t[12]*t[7]*t[9],e.entries[12]=-t[4]*t[9]*t[14]+t[4]*t[10]*t[13]+t[8]*t[5]*t[14]-t[8]*t[6]*t[13]-t[12]*t[5]*t[10]+t[12]*t[6]*t[9],e.entries[1]=-t[1]*t[10]*t[15]+t[1]*t[11]*t[14]+t[9]*t[2]*t[15]-t[9]*t[3]*t[14]-t[13]*t[2]*t[11]+t[13]*t[3]*t[10],e.entries[5]=t[0]*t[10]*t[15]-t[0]*t[11]*t[14]-t[8]*t[2]*t[15]+t[8]*t[3]*t[14]+t[12]*t[2]*t[11]-t[12]*t[3]*t[10],e.entries[9]=-t[0]*t[9]*t[15]+t[0]*t[11]*t[13]+t[8]*t[1]*t[15]-t[8]*t[3]*t[13]-t[12]*t[1]*t[11]+t[12]*t[3]*t[9],e.entries[13]=t[0]*t[9]*t[14]-t[0]*t[10]*t[13]-t[8]*t[1]*t[14]+t[8]*t[2]*t[13]+t[12]*t[1]*t[10]-t[12]*t[2]*t[9],e.entries[2]=t[1]*t[6]*t[15]-t[1]*t[7]*t[14]-t[5]*t[2]*t[15]+t[5]*t[3]*t[14]+t[13]*t[2]*t[7]-t[13]*t[3]*t[6],e.entries[6]=-t[0]*t[6]*t[15]+t[0]*t[7]*t[14]+t[4]*t[2]*t[15]-t[4]*t[3]*t[14]-t[12]*t[2]*t[7]+t[12]*t[3]*t[6],e.entries[10]=t[0]*t[5]*t[15]-t[0]*t[7]*t[13]-t[4]*t[1]*t[15]+t[4]*t[3]*t[13]+t[12]*t[1]*t[7]-t[12]*t[3]*t[5],e.entries[14]=-t[0]*t[5]*t[14]+t[0]*t[6]*t[13]+t[4]*t[1]*t[14]-t[4]*t[2]*t[13]-t[12]*t[1]*t[6]+t[12]*t[2]*t[5],e.entries[3]=-t[1]*t[6]*t[11]+t[1]*t[7]*t[10]+t[5]*t[2]*t[11]-t[5]*t[3]*t[10]-t[9]*t[2]*t[7]+t[9]*t[3]*t[6],e.entries[7]=t[0]*t[6]*t[11]-t[0]*t[7]*t[10]-t[4]*t[2]*t[11]+t[4]*t[3]*t[10]+t[8]*t[2]*t[7]-t[8]*t[3]*t[6],e.entries[11]=-t[0]*t[5]*t[11]+t[0]*t[7]*t[9]+t[4]*t[1]*t[11]-t[4]*t[3]*t[9]-t[8]*t[1]*t[7]+t[8]*t[3]*t[5],e.entries[15]=t[0]*t[5]*t[10]-t[0]*t[6]*t[9]-t[4]*t[1]*t[10]+t[4]*t[2]*t[9]+t[8]*t[1]*t[6]-t[8]*t[2]*t[5];let o=t[0]*e.entries[0]+t[1]*e.entries[4]+t[2]*e.entries[8]+t[3]*e.entries[12];if(0==o)throw"Determinant is zero.";o=1/o;for(let t=0;16>t;t++)this.entries[t]=e.entries[t]*o;return this}static projectVector(e,t){return e.applyProjection(r.multiply(t.projectionMatrix,r.invert(t.modelMatrix)))}static unprojectVector(e,t){return e.applyProjection(r.multiply(t.modelMatrix,r.invert(t.projectionMatrix)))}clone(){return new r(new Float32Array(this.entries))}equals(e){for(let t=0;t<this.entries.length;t++)if(this.entries[t]!==e.entries[t])return!1;return!0}toString(){let e=this.entries[0]+", "+this.entries[4]+", "+this.entries[8]+", "+this.entries[12]+"\n";return e+=this.entries[1]+", "+this.entries[5]+", "+this.entries[9]+", "+this.entries[13]+"\n",e+=this.entries[2]+", "+this.entries[6]+", "+this.entries[10]+", "+this.entries[14]+"\n",e+=this.entries[3]+", "+this.entries[7]+", "+this.entries[11]+", "+this.entries[15]+"\n",e}static multiply(e,t){let o=e.entries[0],n=e.entries[4],s=e.entries[8],i=e.entries[12],a=e.entries[1],c=e.entries[5],l=e.entries[9],m=e.entries[13],d=e.entries[2],p=e.entries[6],f=e.entries[10],u=e.entries[14],g=e.entries[3],x=e.entries[7],h=e.entries[11],v=e.entries[15],y=t.entries[0],b=t.entries[4],P=t.entries[8],N=t.entries[12],A=t.entries[1],_=t.entries[5],S=t.entries[9],C=t.entries[13],E=t.entries[2],M=t.entries[6],z=t.entries[10],T=t.entries[14],F=t.entries[3],L=t.entries[7],w=t.entries[11],I=t.entries[15];return new r(new Float32Array([o*y+n*A+s*E+i*F,a*y+c*A+l*E+m*F,d*y+p*A+f*E+u*F,g*y+x*A+h*E+v*F,o*b+n*_+s*M+i*L,a*b+c*_+l*M+m*L,d*b+p*_+f*M+u*L,g*b+x*_+h*M+v*L,o*P+n*S+s*z+i*w,a*P+c*S+l*z+m*w,d*P+p*S+f*z+u*w,g*P+x*S+h*z+v*w,o*N+n*C+s*T+i*I,a*N+c*C+l*T+m*I,d*N+p*C+f*T+u*I,g*N+x*C+h*T+v*I]))}static fromQuaternion(e){let t=e.components[0],o=e.components[1],n=e.components[2],s=e.components[3],i=t+t,a=o+o,c=n+n,l=t*i,m=t*a,d=t*c,p=o*a,f=o*c,u=n*c,g=s*i,x=s*a,h=s*c;return new r(new Float32Array([1-(p+u),m+h,d-x,0,m-h,1-(l+u),f+g,0,d+x,f-g,1-(l+p),0,0,0,0,1]))}static lookAt(e,t,o){let s=n.subtract(e,t).normalize();0===s.lengthSq()&&(s.components[2]=1);let i=n.cross(o,s).normalize();0===i.lengthSq()&&(s.components[2]+=1e-4,i=n.cross(o,s).normalize());let a=n.cross(s,i);return new r(new Float32Array([i.components[0],i.components[1],i.components[2],0,a.components[0],a.components[1],a.components[2],0,s.components[0],s.components[1],s.components[2],0,0,0,0,1]))}static compose(e,t,o){let n=new r;return n.setRotation(t),n.scale(o),n.setPosition(e),n}static invert(e){let t=new r,o=e.entries;t.entries[0]=o[5]*o[10]*o[15]-o[5]*o[11]*o[14]-o[9]*o[6]*o[15]+o[9]*o[7]*o[14]+o[13]*o[6]*o[11]-o[13]*o[7]*o[10],t.entries[4]=-o[4]*o[10]*o[15]+o[4]*o[11]*o[14]+o[8]*o[6]*o[15]-o[8]*o[7]*o[14]-o[12]*o[6]*o[11]+o[12]*o[7]*o[10],t.entries[8]=o[4]*o[9]*o[15]-o[4]*o[11]*o[13]-o[8]*o[5]*o[15]+o[8]*o[7]*o[13]+o[12]*o[5]*o[11]-o[12]*o[7]*o[9],t.entries[12]=-o[4]*o[9]*o[14]+o[4]*o[10]*o[13]+o[8]*o[5]*o[14]-o[8]*o[6]*o[13]-o[12]*o[5]*o[10]+o[12]*o[6]*o[9],t.entries[1]=-o[1]*o[10]*o[15]+o[1]*o[11]*o[14]+o[9]*o[2]*o[15]-o[9]*o[3]*o[14]-o[13]*o[2]*o[11]+o[13]*o[3]*o[10],t.entries[5]=o[0]*o[10]*o[15]-o[0]*o[11]*o[14]-o[8]*o[2]*o[15]+o[8]*o[3]*o[14]+o[12]*o[2]*o[11]-o[12]*o[3]*o[10],t.entries[9]=-o[0]*o[9]*o[15]+o[0]*o[11]*o[13]+o[8]*o[1]*o[15]-o[8]*o[3]*o[13]-o[12]*o[1]*o[11]+o[12]*o[3]*o[9],t.entries[13]=o[0]*o[9]*o[14]-o[0]*o[10]*o[13]-o[8]*o[1]*o[14]+o[8]*o[2]*o[13]+o[12]*o[1]*o[10]-o[12]*o[2]*o[9],t.entries[2]=o[1]*o[6]*o[15]-o[1]*o[7]*o[14]-o[5]*o[2]*o[15]+o[5]*o[3]*o[14]+o[13]*o[2]*o[7]-o[13]*o[3]*o[6],t.entries[6]=-o[0]*o[6]*o[15]+o[0]*o[7]*o[14]+o[4]*o[2]*o[15]-o[4]*o[3]*o[14]-o[12]*o[2]*o[7]+o[12]*o[3]*o[6],t.entries[10]=o[0]*o[5]*o[15]-o[0]*o[7]*o[13]-o[4]*o[1]*o[15]+o[4]*o[3]*o[13]+o[12]*o[1]*o[7]-o[12]*o[3]*o[5],t.entries[14]=-o[0]*o[5]*o[14]+o[0]*o[6]*o[13]+o[4]*o[1]*o[14]-o[4]*o[2]*o[13]-o[12]*o[1]*o[6]+o[12]*o[2]*o[5],t.entries[3]=-o[1]*o[6]*o[11]+o[1]*o[7]*o[10]+o[5]*o[2]*o[11]-o[5]*o[3]*o[10]-o[9]*o[2]*o[7]+o[9]*o[3]*o[6],t.entries[7]=o[0]*o[6]*o[11]-o[0]*o[7]*o[10]-o[4]*o[2]*o[11]+o[4]*o[3]*o[10]+o[8]*o[2]*o[7]-o[8]*o[3]*o[6],t.entries[11]=-o[0]*o[5]*o[11]+o[0]*o[7]*o[9]+o[4]*o[1]*o[11]-o[4]*o[3]*o[9]-o[8]*o[1]*o[7]+o[8]*o[3]*o[5],t.entries[15]=o[0]*o[5]*o[10]-o[0]*o[6]*o[9]-o[4]*o[1]*o[10]+o[4]*o[2]*o[9]+o[8]*o[1]*o[6]-o[8]*o[2]*o[5];let n=o[0]*t.entries[0]+o[1]*t.entries[4]+o[2]*t.entries[8]+o[3]*t.entries[12];if(0==n)throw"Determinant is zero.";n=1/n;for(let o=0;16>o;o++)t.entries[o]*=n;return t}}t.exports=r},{"./Vector3f":45}],39:[function(e,t){"use strict";const o=e("./Matrix4f"),n=e("../Utils/Utils");t.exports=class extends o{setOrthographic(e,t,o,n,r,s){let i=1/(t-e),a=1/(o-n),c=1/(s-r);return this.setZero(),this.entries[0]=2*i,this.entries[4]=0,this.entries[8]=0,this.entries[12]=-((t+e)*i),this.entries[1]=0,this.entries[5]=2*a,this.entries[9]=0,this.entries[13]=-((o+n)*a),this.entries[2]=0,this.entries[6]=0,this.entries[10]=-2*c,this.entries[14]=-((s+r)*c),this.entries[3]=0,this.entries[7]=0,this.entries[11]=0,this.entries[15]=1,this}setPerspective(e,t,o,r){let s=Math.tan(.5*n.DEG2RAD*e),i=o*s,a=2*i,c=t*a,l=-c/2,m=l+c,d=i-a;return this.setZero(),this.entries[0]=2*o/(m-l),this.entries[4]=0,this.entries[8]=(m+l)/(m-l),this.entries[12]=0,this.entries[1]=0,this.entries[5]=2*o/(i-d),this.entries[9]=(i+d)/(i-d),this.entries[13]=0,this.entries[2]=0,this.entries[6]=0,this.entries[10]=-(r+o)/(r-o),this.entries[14]=-2*r*o/(r-o),this.entries[3]=0,this.entries[7]=0,this.entries[11]=-1,this.entries[15]=0,this}}},{"../Utils/Utils":62,"./Matrix4f":38}],40:[function(e,t){"use strict";var o=Math.sin,n=Math.cos,s=Math.abs,r=Math.sqrt;const i=e("./Vector3f"),a=e("./Matrix4f");class c{constructor(e,t,o,n){1===arguments.length?this.components=new Float32Array(e):2===arguments.length?(this.components=new Float32Array(4),this.setFromAxisAngle(e,t)):(this.components=new Float32Array(4),this.components[0]=e||0,this.components[1]=t||0,this.components[2]=o||0,this.components[3]=n===void 0?1:n)}getX(){return this.components[0]}getY(){return this.components[1]}getZ(){return this.components[2]}getW(){return this.components[3]}set(e,t,o,n){return this.components[0]=e,this.components[1]=t,this.components[2]=o,this.components[3]=n,this}setX(e){return this.components[0]=e,this}setY(e){return this.components[1]=e,this}setZ(e){return this.components[2]=e,this}setW(e){return this.components[3]=e,this}setFromAxisAngle(e,t){let r=i.normalize(e),s=t/2,a=o(s);return this.components[0]=r.components[0]*a,this.components[1]=r.components[1]*a,this.components[2]=r.components[2]*a,this.components[3]=n(s),this}setFromUnitVectors(e,t){let o=null,n=e.dot(t)+1;return 1e-6>n?(o=new i(0,0,0),n=0,s(e.components[0])>s(e.components[2])?o.set(-e.components[1],e.components[0],0):o.set(0,-e.components[2],e.components[1])):o=i.cross(e,t),this.set(o.components[0],o.components[1],o.components[2],n),this.normalize(),this}lookAt(e,t,o){return this.setFromMatrix(a.lookAt(e,t,o)),this}lengthSq(){return this.components[0]*this.components[0]+this.components[1]*this.components[1]+this.components[2]*this.components[2]+this.components[3]*this.components[3]}length(){return r(this.lengthSq())}inverse(){return this.conjugate().normalize()}normalize(){let e=this.length();if(0===e)this.components[0]=0,this.components[1]=0,this.components[2]=0,this.components[3]=1;else{let t=1/e;this.components[0]*=t,this.components[1]*=t,this.components[2]*=t,this.components[3]*=t}return this}dot(e){return this.components[0]*e.components[0]+this.components[1]*e.components[1]+this.components[2]*e.components[2]+this.components[3]*e.components[3]}multiplyA(e){let t=this.components[0]*e.components[3]+this.components[3]*e.components[0]+this.components[1]*e.components[2]-this.components[2]*e.components[1],o=this.components[1]*e.components[3]+this.components[3]*e.components[1]+this.components[2]*e.components[0]-this.components[0]*e.components[2],n=this.components[2]*e.components[3]+this.components[3]*e.components[2]+this.components[0]*e.components[1]-this.components[1]*e.components[0],r=this.components[3]*e.components[3]-this.components[0]*e.components[0]-this.components[1]*e.components[1]-this.components[2]*e.components[2];return this.components[0]=t,this.components[1]=o,this.components[2]=n,this.components[3]=r,this}multiplyB(e){let t=e.components[0]*this.components[3]+e.components[3]*this.components[0]+e.components[1]*this.components[2]-e.components[2]*this.components[1],o=e.components[1]*this.components[3]+e.components[3]*this.components[1]+e.components[2]*this.components[0]-e.components[0]*this.components[2],n=e.components[2]*this.components[3]+e.components[3]*this.components[2]+e.components[0]*this.components[1]-e.components[1]*this.components[0],r=e.components[3]*this.components[3]-e.components[0]*this.components[0]-e.components[1]*this.components[1]-e.components[2]*this.components[2];return this.components[0]=t,this.components[1]=o,this.components[2]=n,this.components[3]=r,this}multiplyScalar(e){return this.components[0]*=e,this.components[1]*=e,this.components[2]*=e,this.components[3]*=e,this}conjugate(){return this.components[0]*=-1,this.components[1]*=-1,this.components[2]*=-1,this}add(e){return this.components[0]+=e.components[0],this.components[1]+=e.components[1],this.components[2]+=e.components[2],this.components[3]+=e.components[3],this}subtract(e){return this.components[0]-=e.components[0],this.components[1]-=e.components[1],this.components[2]-=e.components[2],this.components[3]-=e.components[3],this}rotateX(e){let t=e/2;return this.multiplyA(new c(o(t),0,0,n(t)))}rotateY(e){let t=e/2;return this.multiplyA(new c(0,o(t),0,n(t)))}rotateZ(e){let t=e/2;return this.multiplyA(new c(0,0,o(t),n(t)))}toAxisAngle(){console.warn("The method toAxisAngle() has not been implemented.")}toRotationMatrix(){let e=this.components[0],t=this.components[1],o=this.components[2],n=this.components[3],r=e*e,s=e*o,i=e*n,c=t*n,l=t*t,m=t*o,d=o*o,p=o*n,f=new a;return f.entries[0]=1-2*(l+d),f.entries[1]=2*(e*t+p),f.entries[2]=2*(s-c),f.entries[4]=2*(m-p),f.entries[5]=1-2*(r+d),f.entries[6]=2*(m+i),f.entries[8]=2*(s+c),f.entries[9]=2*(m-i),f.entries[10]=1-2*(r+l),f}setFromMatrix(e){let o=e.entries[0],n=e.entries[4],i=e.entries[8],a=e.entries[1],c=e.entries[5],l=e.entries[9],m=e.entries[2],d=e.entries[6],p=e.entries[10],f=o+c+p;if(0<f){let e=.5/r(f+1);this.components[0]=(d-l)*e,this.components[1]=(i-m)*e,this.components[2]=(a-n)*e,this.components[3]=.25/e}else if(o>c&&o>p){let e=2*r(1+o-c-p);this.components[0]=.25*e,this.components[1]=(n+a)/e,this.components[2]=(i+m)/e,this.components[3]=(d-l)/e}else if(c>p){let e=2*r(1+c-o-p);this.components[0]=(n+a)/e,this.components[1]=.25*e,this.components[2]=(l+d)/e,this.components[3]=(i-m)/e}else{let e=2*r(1+p-o-c);this.components[0]=(i+m)/e,this.components[1]=(l+d)/e,this.components[2]=.25*e,this.components[3]=(a-n)/e}return this}clone(){return new c(this.components[0],this.components[1],this.components[2],this.components[3])}equals(e){return this.components[0]===e.components[0]&&this.components[1]===e.components[1]&&this.components[2]===e.components[2]&&this.components[3]===e.components[3]}toString(){return"x: "+this.getX()+", y: "+this.getY()+", z: "+this.getZ()+", w: "+this.getW()}static dot(e,t){return new c(e.components[0]*t.components[0]+e.components[1]*t.components[1]+e.components[2]*t.components[2]+e.components[3]*t.components[3])}static multiply(e,t){return new c(e.components[0]*t.components[3]+e.components[3]*t.components[0]+e.components[1]*t.components[2]-e.components[2]*t.components[1],e.components[1]*t.components[3]+e.components[3]*t.components[1]+e.components[2]*t.components[0]-e.components[0]*t.components[2],e.components[2]*t.components[3]+e.components[3]*t.components[2]+e.components[0]*t.components[1]-e.components[1]*t.components[0],e.components[3]*t.components[3]+e.components[0]*t.components[0]+e.components[1]*t.components[1]-e.components[2]*t.components[2])}static multiplyScalar(e,t){return new c(e.components[0]*t,e.components[1]*t,e.components[2]*t,e.components[3]*t)}static inverse(e){let t=new c(e.components);return t.conjugate().normalize()}static normalize(e){let t=e.length();if(0===t)return new c(0,0,0,1);else{let o=1/t;return new c(e.components[0]*o,e.components[1]*o,e.components[2]*o,e.components[3]*o)}}static conjugate(e){return new c(-1*e.components[0],-1*e.components[1],-1*e.components[2],e.components[3])}static add(e,t){return new c(e.components[0]+t.components[0],e.components[1]+t.components[1],e.components[2]+t.components[2],e.components[3]+t.components[3])}static subtract(e,t){return new c(e.components[0]-t.components[0],e.components[1]-t.components[1],e.components[2]-t.components[2],e.components[3]-t.components[3])}static fromMatrix(e){let t=new c;return t.setFromMatrix(e),t}static slerp(e,n,i){if(0===i)return new c(e.components);if(1===i)return new c(n.components);let t=new c(n.components),a=e.components[0]*t.components[0]+e.components[1]*t.components[1]+e.components[2]*t.components[2]+e.components[3]*t.components[3];if(0>a&&(t.multiplyScalar(-1),a=-a),1<=s(a))return new c(e.components);let l=Math.acos(a),m=r(1-a*a);if(.001>s(m))return new c(.5*e.components[0]+.5*t.components[0],.5*e.components[1]+.5*t.components[1],.5*e.components[2]+.5*t.components[2],.5*e.components[3]+.5*t.components[3]);let d=o((1-i)*l)/m,p=o(i*l)/m;return new c(e.components[0]*d+t.components[0]*p,e.components[1]*d+t.components[1]*p,e.components[2]*d+t.components[2]*p,e.components[3]*d+t.components[3]*p)}}t.exports=c},{"./Matrix4f":38,"./Vector3f":45}],41:[function(e,t){"use strict";t.exports=class{constructor(){this.max=void 0,this.mask=void 0,this.histograms=void 0,this.indices=void 0,this.tmpIndices=void 0}sort(e,t=!1){let o=null;t?(o=new e.constructor(e.length),o.set(e)):o=e,this.max=2048,this.mask=this.max-1,this.histograms=new Int32Array(6*this.max);let r=new Int32Array(o.buffer,o.byteOffset,o.byteLength>>2),s=Math.ceil(8*o.BYTES_PER_ELEMENT/11),a=this.max*(s-1),i=1<<(8*o.BYTES_PER_ELEMENT-1)%11,c=null,l=new r.constructor(r.length);this.indices=new Uint32Array(r.length),this.tmpIndices=new Uint32Array(r.length);let m=new Uint32Array(r.length),d=this.max*s;for(let o=0;o<d;o++)this.histograms[o]=0;this.initHistograms(r,a,(i<<1)-1);for(let o=0,n;o<=a;o+=this.max){n=0;for(let e=o,t;e<o+this.max;e++)t=this.histograms[e]+n,this.histograms[e]=n-1,n=t}return this.lsbPass(r,l),c=l,l=r,r=c,this.pass(r,l),c=l,l=r,r=c,this.msbPass(r,l,i),{array:new Float32Array(l.buffer,l.byteOffset,o.length),indices:this.indices}}lsbPass(e,t){for(let o=0,r=e.length;o<r;o++){let n=e[o],r=n>>31;n^=2147483648|r;let s=++this.histograms[n&this.mask];this.indices[s]=o,t[s]=n}}pass(e,t){let o=e.length;for(let n=0;n<o;n++){let o=e[n],r=++this.histograms[this.max+(o>>>11&this.mask)];this.tmpIndices[r]=this.indices[n],t[r]=o}this.indices.set(this.tmpIndices)}msbPass(e,t,o){let r=e.length,n=2*this.max;for(let s=0;s<r;s++){let r=e[s],i=++this.histograms[n+(r>>>22&(o<<1)-1)];this.tmpIndices[i]=this.indices[s],t[i]=r^(2147483648|~(r>>31))}this.indices.set(this.tmpIndices)}initHistograms(e,t,o){let r=e.length;for(let n=0;n<r;n++){let r=e[n],s=r>>31;r^=2147483648|s;let i=0,a=0;for(;i<t;i+=this.max,a+=11)this.histograms[i+(r>>>a&this.mask)]++;this.histograms[i+(r>>>a&o)]++}}}},{}],42:[function(e,t){"use strict";const o=e("./Vector3f"),n=e("./ProjectionMatrix"),r=e("./Matrix4f");t.exports=class{constructor(e,t){this.source=e||new o(0,0,0),this.direction=t||new o(0,0,0)}copyFrom(e){return this.source.copyFrom(e.source),this.direction.copyFrom(e.direction),this}applyProjection(e){return this.direction.add(this.source).applyProjection(e),this.source.applyProjection(e),this.direction.subtract(this.source),this.direction.normalize(),this}distanceSqToPoint(e){let t=o.subtract(e,this.source),n=t.dot(this.direction);return 0>n?this.source.distanceToSq(e):(t.copyFrom(this.direction).multiplyScalar(n).add(this.source),t.distanceToSq(e))}closestPointToPoint(e){let t=o.subtract(e,this.source),n=t.dot(this.direction);return 0>n?t.copyFrom(this.source):t.copyFrom(this.direction).multiplyScalar(n).add(this.source)}}},{"./Matrix4f":38,"./ProjectionMatrix":39,"./Vector3f":45}],43:[function(e,t){"use strict";var o=Math.min,n=Math.max;e("./Vector3f");class r{constructor(e=1,t=0,o=0){this.components=new Float32Array(3),this.radius=e,this.phi=t,this.theta=o}set(e,t,o){return this.components[0]=e,this.components[1]=t,this.components[2]=o,this}secure(){return this.components[1]=n(1e-6,o(Math.PI-1e-6,this.components[1])),this}setFromVector(e){return this.components[0]=e.length(),0===this.components[0]?(this.components[1]=0,this.components[2]=0):(this.components[1]=Math.acos(n(-1,o(1,e.components[1]/this.components[0]))),this.components[2]=Math.atan2(e.components[0],e.components[2])),this}limit(e,t,r,s){return this.components[1]=n(e,o(t,this.components[1])),this.components[2]=n(r,o(s,this.components[2])),this}clone(){return new r(this.radius,this.phi,this.theta)}toString(){return"("+this.components[0]+", "+this.components[1]+", "+this.components[2]+")"}}t.exports=r},{"./Vector3f":45}],44:[function(e,t){"use strict";class o{static transpose2dArray(e){return e[0].map((t,o)=>e.map((e)=>e[o]))}static randomNormal(){let e,t,n,r,s;if(null!==o.spareRandomNormal)e=o.spareRandomNormal,o.spareRandomNormal=null;else{do t=2*Math.random()-1,n=2*Math.random()-1,r=t*t+n*n;while(0===r||1<=r);s=Math.sqrt(-2*Math.log(r)/r),e=t*s,o.spareRandomNormal=n*s}return e/14}static randomNormalInRange(e,t){let n;do n=o.randomNormal();while(n<e||n>t);return n}static randomNormalScaled(e,t){let n=o.randomNormalInRange(-1,1);return n*t+e}static normalize(e){let t=e.slice(),o=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;for(let r=0,s;r<t.length;r++)s=t[r],s>o&&(o=s),s<n&&(n=s);let r=o-n;for(let o=0;o<t.length;o++)t[o]=(t[o]-n)/r;return t}static normalizeNoOutliers(e,t=.25,n=.75,r=1.5){let s=e.slice();s.sort((e,t)=>e-t);let i=o.getPercentile(s,t),a=o.getPercentile(s,n),c=a-i,l=i-c*r,m=a+c*r;for(let o=0;o<e.length;o++)s[o]=e[o]<l?0:e[o]>m?1:(e[o]-l)/(m-l);return s}static getPercentile(e,t){var o=Math.floor;let n=t*e.length;return o(n)===n?(e[n-1]+e[n])/2:e[o(n)]}static scale(e,t,o,n,r){return(r-n)*(e-t)/(o-t)+n}}o.spareRandomNormal=null,t.exports=o},{}],45:[function(e,t){"use strict";var o=Math.sin,n=Math.cos,r=Math.sqrt;e("./SphericalCoords");class i{constructor(e,t,o){1===arguments.length?this.components=new Float32Array(e):(this.components=new Float32Array(3),this.components[0]=e||0,this.components[1]=t||0,this.components[2]=o||0)}set(e,t,o){return this.components[0]=e,this.components[1]=t,this.components[2]=o,this}getX(){return this.components[0]}getY(){return this.components[1]}getZ(){return this.components[2]}setX(e){return this.components[0]=e,this}setY(e){return this.components[1]=e,this}setZ(e){return this.components[2]=e,this}setFromSphericalCoords(e){var r=e.components[0],s=e.components[1],i=e.components[2],a=o(s)*r;return this.components[0]=o(i)*a,this.components[1]=n(s)*r,this.components[2]=n(i)*a,this}copyFrom(e){return this.components[0]=e.components[0],this.components[1]=e.components[1],this.components[2]=e.components[2],this}setLength(e){return this.multiplyScalar(e/this.length())}lengthSq(){return this.components[0]*this.components[0]+this.components[1]*this.components[1]+this.components[2]*this.components[2]}length(){return r(this.lengthSq())}normalize(){return this.divideScalar(this.length())}multiply(e){return this.components[0]*=e.components[0],this.components[1]*=e.components[1],this.components[2]*=e.components[2],this}multiplyScalar(e){return this.components[0]*=e,this.components[1]*=e,this.components[2]*=e,this}divide(e){return this.components[0]/=e.components[0],this.components[1]/=e.components[1],this.components[2]/=e.components[2],this}divideScalar(e){return this.components[0]/=e,this.components[1]/=e,this.components[2]/=e,this}add(e){return this.components[0]+=e.components[0],this.components[1]+=e.components[1],this.components[2]+=e.components[2],this}subtract(e){return this.components[0]-=e.components[0],this.components[1]-=e.components[1],this.components[2]-=e.components[2],this}dot(e){return this.components[0]*e.components[0]+this.components[1]*e.components[1]+this.components[2]*e.components[2]}cross(e){return new i(this.components[1]*e.components[2]-this.components[2]*e.components[1],this.components[2]*e.components[0]-this.components[0]*e.components[2],this.components[0]*e.components[1]-this.components[1]*e.components[0])}applyProjection(t){var o=this.components[0],n=this.components[1],r=this.components[2],s=t.entries,e=1/(s[3]*o+s[7]*n+s[11]*r+s[15]);return this.components[0]=(s[0]*o+s[4]*n+s[8]*r+s[12])*e,this.components[1]=(s[1]*o+s[5]*n+s[9]*r+s[13])*e,this.components[2]=(s[2]*o+s[6]*n+s[10]*r+s[14])*e,this}toDirection(t){var o=this.components[0],n=this.components[1],r=this.components[2],s=t.entries;return this.components[0]=s[0]*o+s[4]*n+s[8]*r,this.components[1]=s[1]*o+s[5]*n+s[9]*r,this.components[2]=s[2]*o+s[6]*n+s[10]*r,this.normalize(),this}applyQuaternion(e){var t=this.components[0],o=this.components[1],n=this.components[2],r=e.components[0],s=e.components[1],i=e.components[2],a=e.components[3],c=a*t+s*n-i*o,l=a*o+i*t-r*n,m=a*n+r*o-s*t,d=-r*t-s*o-i*n;return this.components[0]=c*a+d*-r+l*-i-m*-s,this.components[1]=l*a+d*-s+m*-r-c*-i,this.components[2]=m*a+d*-i+c*-s-l*-r,this}distanceToSq(e){var t=this.components[0]-e.components[0],o=this.components[1]-e.components[1],n=this.components[2]-e.components[2];return t*t+o*o+n*n}distanceTo(e){return r(this.distanceToSq(e))}clone(){return new i(this.components[0],this.components[1],this.components[2])}equals(e){return this.components[0]===e.components[0]&&this.components[1]===e.components[1]&&this.components[2]===e.components[2]}toString(){return"("+this.components[0]+", "+this.components[1]+", "+this.components[2]+")"}static normalize(e){return i.divideScalar(e,e.length())}static multiply(e,t){return new i(e.components[0]*t.components[0],e.components[1]*t.components[1],e.components[2]*t.components[2])}static multiplyScalar(e,t){return new i(e.components[0]*t,e.components[1]*t,e.components[2]*t)}static divide(e,t){return new i(e.components[0]/t.components[0],e.components[1]/t.components[1],e.components[2]/t.components[2])}static divideScalar(e,t){return new i(e.components[0]/t,e.components[1]/t,e.components[2]/t)}static add(e,t){return new i(e.components[0]+t.components[0],e.components[1]+t.components[1],e.components[2]+t.components[2])}static subtract(e,t){return new i(e.components[0]-t.components[0],e.components[1]-t.components[1],e.components[2]-t.components[2])}static cross(e,t){return new i(e.components[1]*t.components[2]-e.components[2]*t.components[1],e.components[2]*t.components[0]-e.components[0]*t.components[2],e.components[0]*t.components[1]-e.components[1]*t.components[0])}static dot(e,t){return e.components[0]*t.components[0]+e.components[1]*t.components[1]+e.components[2]*t.components[2]}static forward(){return new i(0,0,1)}static up(){return new i(0,1,0)}static right(){return new i(1,0,0)}}t.exports=i},{"./SphericalCoords":43}],46:[function(e,t){"use strict";const o=e("./Matrix3f"),n=e("./Matrix4f"),r=e("./ProjectionMatrix"),s=e("./Quaternion"),i=e("./RadixSort"),a=e("./Ray"),c=e("./SphericalCoords"),l=e("./Statistics"),m=e("./Vector3f");t.exports={Matrix3f:o,Matrix4f:n,ProjectionMatrix:r,Quaternion:s,RadixSort:i,Ray:a,SphericalCoords:c,Statistics:l,Vector3f:m}},{"./Matrix3f":37,"./Matrix4f":38,"./ProjectionMatrix":39,"./Quaternion":40,"./RadixSort":41,"./Ray":42,"./SphericalCoords":43,"./Statistics":44,"./Vector3f":45}],47:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("circle",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","varying vec3 vColor;","varying float vDiscard;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","vec3 N;","N.xy = gl_PointCoord * 2.0 - vec2(1.0);","float mag = dot(N.xy, N.xy);","if (mag > 1.0) discard;   // discard fragments outside circle","float fogIntensity = (gl_FragCoord.z / gl_FragCoord.w) * 2.0;","fogIntensity *= clearColor.w;","gl_FragColor = mix(vec4(vColor, 1.0), clearColor, fogIntensity);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],48:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("coordinates",1,{},["attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","gl_PointSize = 1.0;","vColor = color;","}"],["varying vec3 vColor;","void main() {","gl_FragColor = vec4(vColor, 1.0);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],49:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("default",1,{size:new n("size",5,"float"),type:new n("type",0,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","varying vec3 vColor;","varying float vDiscard;","void main() {","if(vDiscard > 0.5) discard;","float fogIntensity = (gl_FragCoord.z / gl_FragCoord.w);","fogIntensity = fogIntensity + fogIntensity * 2.0;","fogIntensity *= clearColor.w;","gl_FragColor = mix(vec4(vColor, 1.0), clearColor, fogIntensity);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],50:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("defaultAnimated",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),time:new n("time",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4")},["uniform float size;","uniform float cutoff;","uniform float time;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = size;","hsv.g *= max(0.15, abs(sin(time * 0.002)));","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","varying vec3 vColor;","varying float vDiscard;","void main() {","if(vDiscard > 0.5) discard;","float fogIntensity = (gl_FragCoord.z / gl_FragCoord.w);","fogIntensity = fogIntensity + fogIntensity * 2.0;","fogIntensity *= clearColor.w;","gl_FragColor = mix(vec4(vColor, 1.0), clearColor, fogIntensity);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],51:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("defaultEffect",1,{},["attribute vec2 v_coord;","uniform sampler2D fbo_texture;","varying vec2 f_texcoord;","void main() {","gl_Position = vec4(v_coord, 0.0, 1.0);","f_texcoord = (v_coord + 1.0) / 2.0;","}"],["uniform sampler2D fbo_texture;","varying vec2 f_texcoord;","void main(void) {","vec4 color = texture2D(fbo_texture, f_texcoord);","gl_FragColor = color;","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],52:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("FXAAEffect",1,{resolution:new n("resolution",[500,500],"float_vec2")},["attribute vec2 v_coord;","uniform sampler2D fbo_texture;","uniform vec2 resolution;","varying vec2 f_texcoord;","void main() {","gl_Position = vec4(v_coord, 0.0, 1.0);","f_texcoord = (v_coord + 1.0) / 2.0;","}"],["#define fxaaTexture2D(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#define fxaaSat(x) clamp(x, 0.0, 1.0)","#define FXAA_QUALITY_PS 8","#define FXAA_QUALITY_P0 1.0","#define FXAA_QUALITY_P1 1.5","#define FXAA_QUALITY_P2 2.0","#define FXAA_QUALITY_P3 2.0","#define FXAA_QUALITY_P4 2.0","#define FXAA_QUALITY_P5 2.0","#define FXAA_QUALITY_P6 4.0","#define FXAA_QUALITY_P7 12.0","vec4 fxaa(vec2 pos, sampler2D tex, vec2 resolution,","float subpixQuality, float edgeThreshold, float edgeThresholdMin) {","vec2 posM;","posM.x = pos.x;","posM.y = pos.y;","vec4 rgbyM = texture2D(tex, posM);","vec3 luma = vec3(0.299, 0.587, 0.114);","float lumaM = dot(rgbyM.xyz, luma);","float lumaS = dot(fxaaTexture2D(tex, posM, vec2(0, 1), resolution.xy).xyz, luma);","float lumaE = dot(fxaaTexture2D(tex, posM, vec2(1, 0), resolution.xy).xyz, luma);","float lumaN = dot(fxaaTexture2D(tex, posM, vec2(0, -1), resolution.xy).xyz, luma);","float lumaW = dot(fxaaTexture2D(tex, posM, vec2(-1, 0), resolution.xy).xyz, luma);","float maxSM = max(lumaS, lumaM);","float minSM = min(lumaS, lumaM);","float maxESM = max(lumaE, maxSM);","float minESM = min(lumaE, minSM);","float maxWN = max(lumaN, lumaW);","float minWN = min(lumaN, lumaW);","float rangeMax = max(maxWN, maxESM);","float rangeMin = min(minWN, minESM);","float rangeMaxScaled = rangeMax * edgeThreshold;","float range = rangeMax - rangeMin;","float rangeMaxClamped = max(edgeThresholdMin, rangeMaxScaled);","bool earlyExit = range < rangeMaxClamped;","// maybe return rgbyM -> leave unchanged","if(earlyExit) return rgbyM;","float lumaNW = dot(fxaaTexture2D(tex, posM, vec2(-1, -1), resolution.xy).xyz, luma);","float lumaSE = dot(fxaaTexture2D(tex, posM, vec2(1, 1), resolution.xy).xyz, luma);","float lumaNE = dot(fxaaTexture2D(tex, posM, vec2(1, -1), resolution.xy).xyz, luma);","float lumaSW = dot(fxaaTexture2D(tex, posM, vec2(-1, 1), resolution.xy).xyz, luma);","float lumaNS = lumaN + lumaS;","float lumaWE = lumaW + lumaE;","float subpixRcpRange = 1.0 / range;","float subpixNSWE = lumaNS + lumaWE;","float edgeHorz1 = (-2.0 * lumaM) + lumaNS;","float edgeVert1 = (-2.0 * lumaM) + lumaWE;","float lumaNESE = lumaNE + lumaSE;","float lumaNWNE = lumaNW + lumaNE;","float edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","float edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","float lumaNWSW = lumaNW + lumaSW;","float lumaSWSE = lumaSW + lumaSE;","float edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","float edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","float edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","float edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","float edgeHorz = abs(edgeHorz3) + edgeHorz4;","float edgeVert = abs(edgeVert3) + edgeVert4;","float subpixNWSWNESE = lumaNWSW + lumaNESE;","float lengthSign = resolution.x;","bool horzSpan = edgeHorz >= edgeVert;","float subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","if(!horzSpan) lumaN = lumaW;","if(!horzSpan) lumaS = lumaE;","if(horzSpan) lengthSign = resolution.y;","float subpixB = (subpixA * (1.0/12.0)) - lumaM;","float gradientN = lumaN - lumaM;","float gradientS = lumaS - lumaM;","float lumaNN = lumaN + lumaM;","float lumaSS = lumaS + lumaM;","bool pairN = abs(gradientN) >= abs(gradientS);","float gradient = max(abs(gradientN), abs(gradientS));","if(pairN) lengthSign = -lengthSign;","float subpixC = fxaaSat(abs(subpixB) * subpixRcpRange);","vec2 posB;","posB.x = posM.x;","posB.y = posM.y;","vec2 offNP;","offNP.x = (!horzSpan) ? 0.0 : resolution.x;","offNP.y = ( horzSpan) ? 0.0 : resolution.y;","if(!horzSpan) posB.x += lengthSign * 0.5;","if( horzSpan) posB.y += lengthSign * 0.5;","vec2 posN;","posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","vec2 posP;","posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","float subpixD = ((-2.0)*subpixC) + 3.0;","float lumaEndN = texture2D(tex, posN).w;","float subpixE = subpixC * subpixC;","float lumaEndP = texture2D(tex, posP).w;","if(!pairN) lumaNN = lumaSS;","float gradientScaled = gradient * 1.0/4.0;","float lumaMM = lumaM - lumaNN * 0.5;","float subpixF = subpixD * subpixE;","bool lumaMLTZero = lumaMM < 0.0;","lumaEndN -= lumaNN * 0.5;","lumaEndP -= lumaNN * 0.5;","bool doneN = abs(lumaEndN) >= gradientScaled;","bool doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","bool doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","#if (FXAA_QUALITY_PS > 3)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","#if (FXAA_QUALITY_PS > 4)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","#if (FXAA_QUALITY_PS > 5)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","#if (FXAA_QUALITY_PS > 6)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","#if (FXAA_QUALITY_PS > 7)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","#if (FXAA_QUALITY_PS > 8)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","#if (FXAA_QUALITY_PS > 9)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","#if (FXAA_QUALITY_PS > 10)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","#if (FXAA_QUALITY_PS > 11)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","#if (FXAA_QUALITY_PS > 12)","if(doneNP) {","if(!doneN) lumaEndN = dot(texture2D(tex, posN.xy).xyz, luma);","if(!doneP) lumaEndP = dot(texture2D(tex, posP.xy).xyz, luma);","if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","doneN = abs(lumaEndN) >= gradientScaled;","doneP = abs(lumaEndP) >= gradientScaled;","if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","doneNP = (!doneN) || (!doneP);","if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","#endif","}","float dstN = posM.x - posN.x;","float dstP = posP.x - posM.x;","if(!horzSpan) dstN = posM.y - posN.y;","if(!horzSpan) dstP = posP.y - posM.y;","bool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","float spanLength = (dstP + dstN);","bool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","float spanLengthRcp = 1.0 / spanLength;","bool directionN = dstN < dstP;","float dst = min(dstN, dstP);","bool goodSpan = directionN ? goodSpanN : goodSpanP;","float subpixG = subpixF * subpixF;","float pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","float subpixH = subpixG * subpixQuality;","float pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","float pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","// maybe return vec4(texture2D(tex, posM).xyz, lumaM);","return texture2D(tex, posM);","}","uniform sampler2D fbo_texture;","uniform vec2 resolution;","varying vec2 f_texcoord;","void main(void) {","gl_FragColor = fxaa(f_texcoord, fbo_texture, vec2(1.0 / resolution.x, 1.0 / resolution.y), 0.75, 0.166, 0.0833);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],53:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("simpleSphere",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[0,0,0,1],"float_vec4")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","varying vec3 vColor;","varying float vDiscard;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","vec3 N;","N.xy = gl_PointCoord * 2.0 - vec2(1.0);","float mag = dot(N.xy, N.xy);","if (mag > 1.0) discard;   // discard fragments outside circle","N.z = sqrt(1.0 - mag);","vec3 light_dir = vec3(0.25, -0.25, 1.0);","float diffuse = max(0.25, dot(light_dir, N));","float fogIntensity = (gl_FragCoord.z / gl_FragCoord.w);","fogIntensity = fogIntensity + fogIntensity * 2.0;","fogIntensity *= clearColor.w;","vec3 color = vColor * diffuse;","gl_FragColor = mix(vec4(color, 1.0), clearColor, fogIntensity);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],54:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("smoothCircle",2,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[1,1,1,1],"float_vec4")},["uniform float size;","uniform float cutoff;","in vec3 position;","in vec3 color;","out vec3 vColor;","out float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","in vec3 vColor;","in float vDiscard;","out vec4 fragColor;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","float r = 0.0, delta = 0.0, alpha = 1.0;","vec2 cxy = 2.0 * gl_PointCoord - 1.0;","r = dot(cxy, cxy);","delta = fwidth(r);","alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);","float fogIntensity = (gl_FragCoord.z / gl_FragCoord.w);","fogIntensity = fogIntensity + fogIntensity * 2.0;","fogIntensity *= clearColor.w;","// fragColor = vec4(vec3(gl_FragDepth) * fog, 1.0);","fragColor = mix(vec4(vColor, 1.0), clearColor, fogIntensity) * alpha;","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],55:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("sphere",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float"),clearColor:new n("clearColor",[1,1,1,1],"float_vec4")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 1.0);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0 || mv_pos.z > 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = point_size * size;","vColor = hsv2rgb(hsv);","}"],["uniform vec4 clearColor;","varying vec3 vColor;","varying float vDiscard;","float rand(vec2 co) {","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(vDiscard > 0.5) discard;","vec3 N;","N.xy = gl_PointCoord * 2.0 - vec2(1.0);","float mag = dot(N.xy, N.xy);","if (mag > 1.0) discard;   // discard fragments outside circle","N.z = sqrt(1.0 - mag);","vec3 light_dir = vec3(0.25, -0.25, 1.0);","float diffuse = max(0.25, dot(light_dir, N));","vec3 v = normalize(vec3(0.1, -0.2, 1.0));","vec3 h = normalize(light_dir + v);","float specular = pow(max(0.0, dot(N, h)), 100.0);","// specular += 0.1 * rand(gl_PointCoord);","float fogIntensity = (gl_FragCoord.z / gl_FragCoord.w);","fogIntensity = fogIntensity + fogIntensity * 2.0;","fogIntensity *= clearColor.w;","vec3 color = vColor * diffuse + specular * 0.5;","gl_FragColor = mix(vec4(color, 1.0), clearColor, fogIntensity);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],56:[function(e,t){"use strict";const o=e("../Core/Shader"),n=e("../Core/Uniform");t.exports=new o("tree",1,{size:new n("size",5,"float"),cutoff:new n("cutoff",0,"float")},["uniform float size;","uniform float cutoff;","attribute vec3 position;","attribute vec3 color;","varying vec3 vColor;","varying float vDiscard;","vec3 rgb2hsv(vec3 c) {","vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);","vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));","vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));","float d = q.x - min(q.w, q.y);","float e = 1.0e-10;","return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);","}","vec3 hsv2rgb(vec3 c) {","vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);","vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);","return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);","}","void main() {","vec3 hsv = vec3(color.r, color.g, 0.75);","float saturation = color.g;","float point_size = color.b;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vec4 mv_pos = modelViewMatrix * vec4(position, 1.0);","vDiscard = 0.0;","if(-mv_pos.z < cutoff || point_size <= 0.0) {","vDiscard = 1.0;","return;","}","gl_PointSize = size;","vColor = hsv2rgb(hsv);","}"],["varying vec3 vColor;","varying float vDiscard;","void main() {","if(vDiscard > 0.5) discard;","float fog = 1.0 - (gl_FragCoord.z / gl_FragCoord.w);","gl_FragColor = vec4(vColor * fog, 0.5);","}"])},{"../Core/Shader":18,"../Core/Uniform":20}],57:[function(e,t){"use strict";var o=e("./Circle"),n=e("./Coordinates"),r=e("./Default"),s=e("./DefaultAnimated"),i=e("./DefaultEffect"),a=e("./SimpleSphere"),c=e("./SmoothCircle"),l=e("./Sphere"),m=e("./Tree"),d=e("./FXAAEffect");t.exports={circle:o,coordinates:n,defaultSquare:r,defaultAnimated:s,defaultEffect:i,simpleSphere:a,smoothCircle:c,sphere:l,tree:m,fxaaEffect:d}},{"./Circle":47,"./Coordinates":48,"./Default":49,"./DefaultAnimated":50,"./DefaultEffect":51,"./FXAAEffect":52,"./SimpleSphere":53,"./SmoothCircle":54,"./Sphere":55,"./Tree":56}],58:[function(e,t){"use strict";var o=Math.pow,n=Math.min,r=Math.max;const s=e("../Math/Vector3f");class a{constructor(e,t){this.center=e||new s(0,0,0),this.radius=t||0,this.locCode=0,this.left=0,this.right=0,this.back=0,this.front=0,this.bottom=0,this.top=0,this.neighbours=[,,,,,,],this.min=new Float32Array(3),this.max=new Float32Array(3),this.updateDimensions()}updateDimensions(){let e=this.center.components[0],t=this.center.components[1],o=this.center.components[2];return this.min[0]=e-this.radius,this.min[1]=t-this.radius,this.min[2]=o-this.radius,this.max[0]=e+this.radius,this.max[1]=t+this.radius,this.max[2]=o+this.radius,this.left=e-this.radius,this.right=e+this.radius,this.back=o-this.radius,this.front=o+this.radius,this.bottom=t-this.radius,this.top=t+this.radius,this}setLocCode(e){return this.locCode=e,this}getLocCode(){return this.locCode}rayTest(e,t,o){let s=e.components,i=t.components,a=(this.left-s[0])*i[0],c=(this.right-s[0])*i[0],l=(this.bottom-s[1])*i[1],m=(this.top-s[1])*i[1],d=(this.back-s[2])*i[2],p=(this.front-s[2])*i[2],f=n(r(a,c),r(l,m),r(d,p));if(0>f)return!1;let u=r(n(a,c),n(l,m),n(d,p));return!(u>f||u>o)}cylinderTest(e,t,o,n){this.radius+=n,this.updateDimensions();let r=this.rayTest(e,t,o);return this.radius-=n,this.updateDimensions(),r}distanceToPointSq(e,t,n){let r=0,s=[e,t,n];for(var a=0;3>a;a++)s[a]<this.min[a]&&(r+=o(this.min[a]-s[a],2)),s[a]>this.max[a]&&(r+=o(s[a]-this.max[a],2));return r}distanceFromCenterToPointSq(e,t,n){let r=this.center.components;return o(r[0]-e,2)+o(r[1]-t,2)+o(r[2]-n,2)}testAABB(e){for(var t=0;3>t;t++)if(this.max[t]<e.min[t]||this.min[t]>e.max[t])return!1;return!0}static fromPoints(e){let t=e[0],o=e[1],n=e[2],c=new s(t,o,n),l=new s(t,o,n),m=c.components,d=l.components;for(var p=1;p<e.length/3;p++)e[3*p+0]<m[0]&&(m[0]=e[3*p+0]),e[3*p+1]<m[1]&&(m[1]=e[3*p+1]),e[3*p+2]<m[2]&&(m[2]=e[3*p+2]),e[3*p+0]>d[0]&&(d[0]=e[3*p+0]),e[3*p+1]>d[1]&&(d[1]=e[3*p+1]),e[3*p+2]>d[2]&&(d[2]=e[3*p+2]);let i=s.subtract(l,c);i.multiplyScalar(.5);let f=i.components[0],u=i.components[1],g=i.components[2],x=new s(f,u,g);x.add(c);let h=r(f,u,g);return new a(x,h)}static getCorners(e){let t=e.center.components,o=t[0],n=t[1],s=t[2],i=e.radius;return[[o-i,n-i,s-i],[o-i,n-i,s+i],[o-i,n+i,s-i],[o-i,n+i,s+i],[o+i,n-i,s-i],[o+i,n-i,s+i],[o+i,n+i,s-i],[o+i,n+i,s+i]]}static clone(e){let t=new a;return t.back=e.back,t.bottom=e.bottom,t.center=new s(e.center.components[0],e.center.components[1],e.center.components[2]),t.front=e.front,t.left=e.left,t.locCode=e.locCode,t.max=e.max,t.min=e.min,t.radius=e.radius,t.right=e.right,t.top=e.top,t}}t.exports=a},{"../Math/Vector3f":45}],59:[function(e,t){"use strict";var o=Number.MIN_VALUE,n=Number.MAX_VALUE,r=Math.pow;const s=e("./AABB"),a=e("../Math/Vector3f"),l=e("../Utils/Utils"),i=e("./Raycaster"),c=e("../Math/RadixSort");class m{constructor(e,t){this.threshold=e||500,this.maxDepth=t||8,this.points={},this.aabbs={},this.offsets=[[-.5,-.5,-.5],[-.5,-.5,+.5],[-.5,+.5,-.5],[-.5,+.5,+.5],[+.5,-.5,-.5],[+.5,-.5,+.5],[+.5,+.5,-.5],[+.5,+.5,+.5]]}build(e,t,n,o=1){n.setLocCode(o),this.points[o]=null,this.aabbs[o]=n;let r=this.getDepth(o);if(e.length<=this.threshold||r>=this.maxDepth){this.points[o]=new Uint32Array(e.length);for(var c=0;c<e.length;c++)this.points[o][c]=e[c];return!0}let i=new Uint32Array(8),l=new Float32Array(e.length);for(var c=0;c<e.length;c++){let o=3*e[c];t[o+0]>=n.center.components[0]&&(l[c]|=4),t[o+1]>=n.center.components[1]&&(l[c]|=2),t[o+2]>=n.center.components[2]&&(l[c]|=1),i[l[c]]++}let m=Array(8),d=Array(8);for(var c=0;8>c;c++){if(0==i[c])continue;m[c]=new Uint32Array(i[c]);for(var p=0,f=0;p<e.length;p++)l[p]==c&&(m[c][f++]=e[p]);let t=this.offsets[c],o=new a(t[0],t[1],t[2]);o.multiplyScalar(n.radius),d[c]=new s(n.center.clone().add(o),.5*n.radius)}for(var c=0;8>c;c++){if(0==i[c])continue;let e=this.generateLocCode(o,c);this.build(m[c],t,d[c],e)}return this}getLocCodes(){return Object.keys(this.aabbs)}getDepth(e){return l.msb(e)/3}generateLocCode(e,t){let o=l.msb(e);return-1==o?8|t:(e=e<<=3,e|t)}traverse(e,t=1){for(var o=0;8>o;o++){let n=t<<3|o;this.aabbs[n]&&(e(this.points[n],this.aabbs[n],n),this.traverse(e,n))}}traverseIf(e,t,o=1){for(var n=0;8>n;n++){let r=o<<3|n;if(this.aabbs[r]){if(!t(this.aabbs[r],r))continue;e(this.points[r],this.aabbs[r],r),this.traverseIf(e,t,r)}}}raySearch(e){let t=[];if(this.points[1])for(var o=0;o<this.points[1].length;o++)t.push({index:this.points[1][o],locCode:1});let n=e.ray.direction.clone();n.normalize();let r=new a(1,1,1);return r.divide(n),this.traverseIf(function(e,o,n){if(e)for(var r=0;r<e.length;r++)t.push({index:e[r],locCode:n})},function(t){return t.cylinderTest(e.ray.source,r,e.far,e.threshold)}),t}getCenters(e){e=e||0;let t=[];return this.traverse(function(o,n){o&&o.length>e&&t.push(n.center)}),t}getClosestBox(e,t,o=1){let r=-1,s=n;for(var a=0;8>a;a++){let n=o<<3|a;if(this.aabbs[n]){if(this.points[n]&&this.points[n].length<t)continue;let o=this.aabbs[n].distanceToPointSq(e.components[0],e.components[1],e.components[2]);o<s&&(s=o,r=n)}}return 0>r?this.aabbs[o]:this.getClosestBox(e,t,r)}getClosestBoxFromCenter(e,t,o=1){let r=-1,s=n;for(var a=0;8>a;a++){let n=o<<3|a;if(this.aabbs[n]){if(this.points[n]&&this.points[n].length<t)continue;let o=this.aabbs[n].distanceFromCenterToPointSq(e.components[0],e.components[1],e.components[2]);o<s&&(s=o,r=n)}}return 0>r?this.aabbs[o]:this.getClosestBox(e,t,r)}getFarthestBox(e,t,n){let r=-1,s=o;for(var a=0;8>a;a++){let o=n<<3|a;if(this.aabbs[o]){if(this.points[o]&&this.points[o].length<t)continue;let n=this.aabbs[o].distanceToPointSq(e.components[0],e.components[1],e.components[2]);n>s&&(s=n,r=o)}}return 0>r?this.aabbs[n]:this.getFarthestBox(e,t,r)}getClosestPoint(e,t,o,s){o=o||0;let c=n,l=null,m=null;m=s?this.aabbs[s]:this.getClosestBox(e,o);let d=this.points[m.getLocCode()];if(!d)return null;for(var p=0;p<d.length;p++){let o=d[p];o*=3;let n=t[o],s=t[o+1],i=t[o+2],a=e.components,m=r(a[0]-n,2)+r(a[1]-s,2)+r(a[2]-i,2);m<c&&(c=m,l={x:n,y:s,z:i})}return l?new a(l.x,l.y,l.z):null}getFarthestPoint(e,t,n,s){n=n||0;let c=o,l=null,m=null;m=s?this.aabbs[s]:this.getFarthestBox(e,n);let d=this.points[m.getLocCode()];if(!d)return null;for(var p=0;p<d.length;p++){let o=d[p];o*=3;let n=t[o],s=t[o+1],i=t[o+2],a=e.components,m=r(a[0]-n,2)+r(a[1]-s,2)+r(a[2]-i,2);m>c&&(c=m,l={x:n,y:s,z:i})}return l?new a(l.x,l.y,l.z):null}getParent(e){return e>>>3}getNeighbours(e){let t=this,o=[];return this.traverseIf(function(t,n,r){t&&0<t.length&&r!=e&&o.push(r)},function(o){return o.testAABB(t.aabbs[e])}),o}kNearestNeighbours(e,t,o,n){e+=1;let r=n.length/3,s=t;if(!isNaN(parseFloat(t))){let e={x:n[3*e],y:n[3*e+1],z:n[3*e+2]}}null===o&&(o=this.getClosestBoxFromCenter(new a(s.x,s.y,s.z),0).locCode);let l=this.getCellDistancesToPoint(s.x,s.y,s.z,o),d=this.pointDistancesSq(s.x,s.y,s.z,o,n),p=new c,f=p.sort(d.distancesSq,!0),u=p.sort(l.distancesSq,!0),g=0,x=0,h=new Uint32Array(e);for(var v=0;x<e&&v<f.array.length;v++){if(f.array[v]>u.array[0]){g=v;break}h[v]=d.indices[f.indices[v]],x++}if(x==e)return h;for(var v=0;v<u.array.length;v++){let t=l.locCodes[u.indices[v]],o=this.pointDistancesSq(s.x,s.y,s.z,t,n);d=m.mergePointDistances(d,o);let a=p.sort(d.distancesSq,!0);for(var i=g;x<e&&i<a.array.length;i++){if(a.array[i]>u.array[v+1]){g=i;break}h[i]=d.indices[a.indices[i]],x++}if(x==e||x>=r-1)return h}return h}getCellDistancesToPoint(e,t,o,n){let r=[];this.traverse(function(e,t,o){e&&0<e.length&&o!=n&&r.push(o)});let s=new Float32Array(r.length);for(var a=0;a<r.length;a++)s[a]=this.aabbs[r[a]].distanceToPointSq(e,t,o);return{locCodes:r,distancesSq:s}}expandNeighbourhood(e,t,o,n,r){let s=r.locCodes,a=r.distancesSq,m=s.length;for(var d=m-1;0<=d;d--){let e=this.getNeighbours(s[d]);for(var i=0;i<e.length;i++)e[i]===n||l.arrayContains(s,e[i])||s.push(e[i])}let p=s.length,f=a.length;if(p!==f){let n=new Float32Array(p-f);for(var d=f,u=0;d<p;d++,u++)n[u]=this.aabbs[s[d]].distanceToPointSq(e,t,o);return r.distancesSq=l.concatTypedArrays(a,n),s.length-m}}cellDistancesSq(e,t,o,n){let r=this.getNeighbours(n),s=new Float32Array(r.length);for(var a=0;a<r.length;a++)s[a]=this.aabbs[r[a]].distanceToPointSq(e,t,o);return{locCodes:r,distancesSq:s}}pointDistancesSq(e,t,o,n,s){let a=this.points[n],c=new Uint32Array(a.length),l=new Float32Array(a.length);for(var m=0;m<a.length;m++){let n=3*a[m],i=s[n],d=s[n+1],p=s[n+2];c[m]=a[m],l[m]=r(i-e,2)+r(d-t,2)+r(p-o,2)}return{indices:c,distancesSq:l}}static concatTypedArrays(e,t){let o=new e.constructor(e.length+t.length);return o.set(e),o.set(t,e.length),o}static mergePointDistances(e,t){let o={indices:m.concatTypedArrays(e.indices,t.indices),distancesSq:m.concatTypedArrays(e.distancesSq,t.distancesSq)};return o}static mergeCellDistances(e,t){let o={locCodes:m.concatTypedArrays(e.locCodes,t.locCodes),distancesSq:m.concatTypedArrays(e.distancesSq,t.distancesSq)};return o}static clone(e){let t=new m;for(var o in t.threshold=e.threshold,t.maxDepth=e.maxDepth,t.points=e.points,e.aabbs)e.aabbs.hasOwnProperty(o)&&(t.aabbs[o]=s.clone(e.aabbs[o]));return t}}t.exports=m},{"../Math/RadixSort":41,"../Math/Vector3f":45,"../Utils/Utils":62,"./AABB":58,"./Raycaster":60}],60:[function(e,t){"use strict";const o=e("../Math/Ray"),n=e("../Math/Matrix4f");t.exports=class{constructor(){this.ray=new o,this.near=0,this.far=1e3,this.threshold=.1}set(e,t,o){return this.near=e.near,this.far=e.far,this.ray.source.set(t,o,(e.near+e.far)/(e.near-e.far)),n.unprojectVector(this.ray.source,e),this.ray.direction.set(0,0,-1),this.ray.direction.toDirection(e.modelMatrix),this}}},{"../Math/Matrix4f":38,"../Math/Ray":42}],61:[function(e,t){"use strict";const o=e("./AABB"),n=e("./Octree"),r=e("./Raycaster");t.exports={AABB:o,Octree:n,Raycaster:r}},{"./AABB":58,"./Octree":59,"./Raycaster":60}],62:[function(e,t){"use strict";class o{static extend(){let e={},t=!1,n=0,r=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],n++);for(let s=function(n){for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=t&&"[object Object]"===Object.prototype.toString.call(n[r])?o.extend(!0,e[r],n[r]):n[r])};n<r;n++){let e=arguments[n];s(e)}return e}static arrayContains(e,t){for(let o=0;o<e.length;o++)if(e[o]===t)return!0;return!1}static concatTypedArrays(e,t){let o=new e.constructor(e.length+t.length);return o.set(e),o.set(t,e.length),o}static msb(e){return 2147483648&e?31:o.msb(1|e<<1)-1}static mergePointDistances(e,t){let n={indices:o.concatTypedArrays(e.indices,t.indices),distancesSq:o.concatTypedArrays(e.distancesSq,t.distancesSq)};return n}static isInt(e){return+e===e&&0==e%1}static isFloat(e){return+e===e&&0!=e%1}static jsonp(e,t){let o="jsonp_callback_"+Math.round(1e5*Math.random());window[o]=function(e){delete window[o],document.body.removeChild(n),t(e)};let n=document.createElement("script");n.src=e+(0<=e.indexOf("?")?"&":"?")+"callback="+o,document.body.appendChild(n)}}o.DEG2RAD=Math.PI/180,t.exports=o},{}],63:[function(e,t){"use strict";const o=e("./Utils");t.exports={Utils:o}},{"./Utils":62}]},{},[1]);
//# sourceMappingURL=lore.min.js.map
